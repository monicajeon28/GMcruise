# 배포 전 발견된 이슈

> **작성일**: 2025-01-20  
> **상태**: 배포 전 수정 필요

---

## 🚨 빌드 오류

### 1. POST 함수 중복 정의 (치명적)

**파일**: `app/api/admin/affiliate/profiles/[profileId]/documents/route.ts`

**오류 메시지**:
```
`POST` redefined here
```

**원인**: 같은 파일에서 `POST` 함수가 두 번 정의됨

**영향도**: 🔴 높음 (빌드 실패)

**해결 방법**:
1. 파일을 확인하여 중복된 `POST` 함수 제거
2. 또는 하나의 `POST` 함수로 통합

**수정 필요**: ✅ 즉시 수정 필요

---

## ⚠️ 알려진 기능 이슈

### 1. 여행지 사진 표시 안 됨

**현상**: "여행지 사진 보기" 질문에서 국가별 관광 사진이 표시되지 않음

**영향도**: 🟡 중간 (기능 누락이지만 챗봇은 작동)

**상태**: 
- 코드는 수정 완료
- 실제 질문 ID 매칭 확인 필요
- 배포 후 모니터링 필요

**배포 가능 여부**: ✅ 가능 (기능 누락이지만 챗봇 자체는 작동)

---

## ✅ 정상 작동 기능

다음 기능들은 정상 작동 확인:
- ✅ 챗봇 시작/질문 로드
- ✅ SPIN 스크립트 흐름
- ✅ 동적 콘텐츠 삽입
- ✅ 영상 표시 (모든 order)
- ✅ 고객 후기 사진 (order 3)
- ✅ 국가별 이미지 매칭 로직
- ✅ 해결책 영상 구분 (다섯번째, 여섯번째, 일곱번째)

---

## 📋 배포 전 필수 수정 사항

### 즉시 수정 필요 (빌드 실패)
1. [ ] `app/api/admin/affiliate/profiles/[profileId]/documents/route.ts` - POST 함수 중복 제거

### 배포 후 모니터링 필요
1. [ ] 여행지 사진 표시 기능 모니터링
2. [ ] API 응답 시간 모니터링
3. [ ] 에러 로그 모니터링

---

## 🔧 수정 가이드

### POST 함수 중복 제거

```typescript
// ❌ 잘못된 예시 (중복)
export async function POST(req: NextRequest, { params }) {
  // ...
}

export async function POST(req: NextRequest, { params }) {  // 중복!
  // ...
}

// ✅ 올바른 예시
export async function POST(req: NextRequest, { params }) {
  // 하나의 POST 함수만 정의
  // 필요시 조건문으로 분기
}
```

---

## 📊 배포 우선순위

### 1단계: 빌드 오류 수정 (필수)
- POST 함수 중복 제거
- 빌드 성공 확인

### 2단계: 기능 테스트
- 모든 챗봇 기능 테스트
- 여행지 사진 이슈 확인 (기능 누락이지만 배포 가능)

### 3단계: 배포
- 스테이징 환경 배포
- 프로덕션 배포

---

**작성자**: AI Assistant  
**최종 업데이트**: 2025-01-20


