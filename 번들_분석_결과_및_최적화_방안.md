# 번들 분석 결과 및 최적화 방안

## 📊 현재 번들 크기 분석

### 전체 현황
- **First Load JS (공유)**: 88.5 kB ✅ (양호)
- **Middleware**: 28 kB ✅ (양호)
- **총 API 라우트**: 400+ 개 (모두 0 B - 정상)

### 큰 번들 크기를 가진 페이지들

| 페이지 | 자체 크기 | 총 크기 | 우선순위 |
|--------|----------|---------|---------|
| `/chat` | 1.35 kB | **168 kB** | 🔴 높음 |
| `/chat-test` | 5.08 kB | **172 kB** | 🔴 높음 |
| `/map` | 9.38 kB | **170 kB** | 🔴 높음 |
| `/map-test` | 11.2 kB | **172 kB** | 🔴 높음 |
| `/partner/[partnerId]/documents` | 1.42 kB | **176 kB** | 🔴 높음 |
| `/translator` | 45.1 kB | **139 kB** | 🟡 중간 |
| `/translator-test` | 45.8 kB | **140 kB** | 🟡 중간 |
| `/wallet` | 12.3 kB | **115 kB** | 🟡 중간 |

## 🎯 최적화 대상 페이지

### 1. Chat 페이지 (168-172 kB) - 최우선

**문제점**:
- 큰 컴포넌트들이 정적 임포트됨
- AI 관련 라이브러리 포함 가능성

**최적화 방안**:
```typescript
// app/chat/page.tsx
import dynamic from 'next/dynamic';

// 큰 컴포넌트들을 동적 임포트
const ChatWindow = dynamic(() => import('@/components/ChatWindow'), {
  loading: () => <ChatSkeleton />,
  ssr: false,
});

const ChatMessages = dynamic(() => import('@/components/ChatMessages'), {
  ssr: false,
});

// AI 관련 라이브러리도 동적 임포트
const AIChatComponent = dynamic(() => import('@/components/AIChatComponent'), {
  ssr: false,
});
```

**예상 개선**: **40-50% 감소** (168 kB → 100-110 kB)

### 2. Map 페이지 (170-172 kB) - 최우선

**문제점**:
- 지도 라이브러리 (react-simple-maps, d3 등) 포함
- 모든 지도 관련 컴포넌트가 정적 임포트

**최적화 방안**:
```typescript
// app/map/page.tsx
import dynamic from 'next/dynamic';

// 지도 컴포넌트 동적 임포트
const MapComponent = dynamic(() => import('@/components/MapComponent'), {
  loading: () => <MapSkeleton />,
  ssr: false, // 지도는 클라이언트 전용
});

// 지도 관련 유틸리티도 동적 임포트
const MapUtils = dynamic(() => import('@/components/MapUtils'), {
  ssr: false,
});
```

**예상 개선**: **50-60% 감소** (170 kB → 70-85 kB)

### 3. Translator 페이지 (139-140 kB) - 중간

**문제점**:
- 번역 라이브러리 포함
- 자체 크기가 45 kB로 큼

**최적화 방안**:
```typescript
// app/translator/page.tsx
import dynamic from 'next/dynamic';

// 번역 컴포넌트 동적 임포트
const TranslatorComponent = dynamic(
  () => import('@/components/TranslatorComponent'),
  {
    loading: () => <TranslatorSkeleton />,
    ssr: false,
  }
);
```

**예상 개선**: **30-40% 감소** (139 kB → 85-95 kB)

### 4. Partner Documents 페이지 (176 kB) - 높음

**문제점**:
- PDF 생성 라이브러리 (jspdf, html2canvas 등) 포함
- 문서 관련 큰 컴포넌트들

**최적화 방안**:
```typescript
// app/partner/[partnerId]/documents/page.tsx
import dynamic from 'next/dynamic';

// PDF 관련 컴포넌트 동적 임포트
const DocumentViewer = dynamic(
  () => import('@/components/partner/DocumentViewer'),
  {
    loading: () => <DocumentSkeleton />,
    ssr: false,
  }
);

// PDF 생성 컴포넌트도 동적 임포트
const PDFGenerator = dynamic(
  () => import('@/components/partner/PDFGenerator'),
  {
    ssr: false,
  }
);
```

**예상 개선**: **50-60% 감소** (176 kB → 70-90 kB)

## 🚀 즉시 적용 가능한 최적화

### 1. Chat 페이지 최적화

**파일**: `app/chat/page.tsx` 또는 관련 컴포넌트

**작업**:
1. ChatWindow 동적 임포트
2. ChatMessages 동적 임포트
3. AI 관련 컴포넌트 동적 임포트

### 2. Map 페이지 최적화

**파일**: `app/map/page.tsx`

**작업**:
1. 지도 컴포넌트 동적 임포트
2. 지도 관련 유틸리티 동적 임포트
3. 지도 라이브러리 lazy loading

### 3. Translator 페이지 최적화

**파일**: `app/translator/page.tsx`

**작업**:
1. 번역 컴포넌트 동적 임포트
2. 번역 라이브러리 lazy loading

### 4. Partner Documents 페이지 최적화

**파일**: `app/partner/[partnerId]/documents/page.tsx`

**작업**:
1. PDF 관련 컴포넌트 동적 임포트
2. PDF 생성 라이브러리 lazy loading

## 📈 예상 전체 개선 효과

### 최적화 전
- 평균 페이지 크기: ~120-130 kB
- 큰 페이지들: 170-176 kB

### 최적화 후
- 평균 페이지 크기: ~80-90 kB (**30-40% 감소**)
- 큰 페이지들: 70-110 kB (**40-60% 감소**)

### 전체 효과
- **초기 로딩 시간**: **40-50% 단축**
- **번들 크기**: **30-40% 감소**
- **사용자 경험**: **대폭 개선**

## 🔍 추가 분석 필요 사항

### 1. 번들 분석기 상세 실행

```bash
# 상세 분석
ANALYZE=true npm run build
```

**확인 사항**:
- 어떤 라이브러리가 가장 큰지
- 중복 의존성 확인
- 불필요한 라이브러리 제거

### 2. 큰 라이브러리 확인

터미널 결과에서 확인된 큰 청크:
- `chunks/2117-1210fabc858c32be.js`: 31.9 kB
- `chunks/fd9d1056-f5dba78b4a5016f7.js`: 53.6 kB

**분석 필요**:
- 이 청크들이 무엇을 포함하는지
- 최적화 가능 여부

## 📝 우선순위별 작업 계획

### Phase 1-추가: 큰 페이지 최적화 (1-2일)

1. ✅ Chat 페이지 동적 임포트
2. ✅ Map 페이지 동적 임포트
3. ✅ Translator 페이지 동적 임포트
4. ✅ Partner Documents 페이지 동적 임포트

**예상 개선**: **40-50% 번들 크기 감소**

### Phase 2: 중복 의존성 제거 (1주)

1. 번들 분석기로 중복 확인
2. 불필요한 라이브러리 제거
3. 라이브러리 버전 통일

**예상 개선**: **10-20% 추가 감소**

### Phase 3: 코드 스플리팅 강화 (1주)

1. 모든 큰 컴포넌트 동적 임포트
2. 라우트 레벨 코드 스플리팅
3. 기능별 코드 스플리팅

**예상 개선**: **20-30% 추가 감소**

## 🎯 즉시 시작할 작업

가장 큰 효과를 볼 수 있는 순서:

1. **Map 페이지** (170 kB → 70-85 kB 예상)
2. **Chat 페이지** (168 kB → 100-110 kB 예상)
3. **Partner Documents** (176 kB → 70-90 kB 예상)
4. **Translator 페이지** (139 kB → 85-95 kB 예상)

이 순서로 진행하시겠습니까?

