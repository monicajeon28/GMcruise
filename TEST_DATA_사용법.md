# 테스트 데이터 사용 가이드

## 📦 생성된 테스트 데이터

- **파트너 계정**: `boss1` (ID: 1)
- **크루즈 상품**: `TEST-MED-001` (지중해 크루즈 7박 8일)
- **여행 일정**: Trip ID 1 (출발일: 2025-05-01)
- **요금표**: 인테리어, 발코니 객실 가격 정보 포함

---

## 🚀 테스트 절차

### 1. 테스트 서버 실행 확인

터미널에서 다음 명령어로 서버가 실행 중인지 확인:

```bash
npm run dev:test
```

서버가 `http://localhost:3001` (또는 다른 포트)에서 실행 중이어야 합니다.

---

### 2. 파트너 로그인

#### 방법 A: 파트너 로그인 페이지 사용

1. 브라우저에서 접속:
   ```
   http://localhost:3001/partner
   ```
   또는
   ```
   http://localhost:3001/partner/login
   ```

2. 로그인 정보 입력:
   - **아이디/전화번호**: `boss1`
   - **비밀번호**: `1101` 또는 `qwe1`
   - **모드**: 파트너 모드 선택 (또는 비밀번호 `qwe1` 입력 시 자동 파트너 모드)

3. 로그인 성공 시 자동으로 `/partner/boss1/dashboard`로 이동

#### 방법 B: 일반 로그인 페이지 사용

1. 브라우저에서 접속:
   ```
   http://localhost:3001/login
   ```

2. 로그인 정보 입력:
   - **이름**: 테스트 대리점장 (또는 아무 이름)
   - **전화번호**: `boss1`
   - **비밀번호**: `1101`
   - **모드**: 파트너 선택 (또는 `qwe1` 입력)

---

### 3. 예약 페이지 접근

로그인 후 다음 경로로 이동:

```
http://localhost:3001/partner/boss1/reservation/new
```

또는 대시보드에서 **"신규 예약 등록"** 버튼 클릭

---

### 4. 테스트할 기능 확인

#### ✅ 여행 상품 목록 로딩
- 페이지 접속 시 드롭다운에 다음 상품이 표시되어야 합니다:
  ```
  2025-05-01 MSC World Europa (Barcelona, Palma, Marseille, Genoa, Naples)
  ```

#### ✅ 요금표 데이터 표시
- 여행 상품을 선택하면 "2. 객실 구매 정보" 섹션에 다음이 표시되어야 합니다:
  - **인테리어** 객실 옵션 (성인: 1,500,000원, 아동: 750,000원)
  - **발코니** 객실 옵션 (성인: 2,500,000원, 아동: 1,250,000원)

#### ✅ 여권 스캔 기능
1. "여행자 추가" 버튼 클릭
2. "여권 스캔" 버튼 클릭
3. 여권 이미지 선택
4. AI가 여권 정보를 자동으로 추출하여 입력 필드에 채워지는지 확인

#### ✅ 객실 배정
1. 객실 타입별 수량 입력 (예: 인테리어 1개, 발코니 1개)
2. 자동으로 방이 생성되는지 확인 (총 2개의 방)
3. 여행자를 드래그하여 방에 배정할 수 있는지 확인

---

## 🐛 문제 해결

### 문제: 여행 상품 목록이 비어있음

**해결 방법:**
1. 브라우저 개발자 도구(F12) 열기
2. Network 탭 확인
3. `/api/partner/trips` 요청 상태 확인:
   - **200 OK**: 응답 데이터 확인 (빈 배열인지, 데이터가 있는지)
   - **500 에러**: 서버 콘솔 에러 확인
   - **404 에러**: API 경로 확인

**확인 명령어:**
```bash
# 서버가 DATABASE_URL_TEST를 사용하는지 확인
echo $DATABASE_URL
# 또는 .env 파일에서 DATABASE_URL_TEST 확인
```

### 문제: 요금표가 표시되지 않음

**확인 사항:**
1. 여행 상품을 선택했는지 확인
2. 브라우저 콘솔에 에러가 있는지 확인
3. 다음 API 응답 확인:
   ```javascript
   // 브라우저 콘솔에서
   fetch('/api/partner/trips')
     .then(r => r.json())
     .then(data => console.log(data.trips[0]?.product?.MallProductContent))
   ```

### 문제: 여권 스캔 버튼이 작동하지 않음

**확인 사항:**
1. 브라우저 개발자 도구(F12) 콘솔 확인
2. 에러 메시지 확인:
   - `404`: `/api/passport/scan` 경로 확인
   - `500`: 서버 콘솔 에러 확인
   - `GEMINI_API_KEY`: 환경 변수 확인

**확인 명령어:**
```bash
# 서버 콘솔에서 확인
echo $GEMINI_API_KEY
# 또는 .env 파일 확인
```

---

## 📊 예상 화면 구성

```
┌─────────────────────────────────────────────┐
│  신규 예약 등록                              │
├─────────────────────────────────────────────┤
│  1. 여행 상품 선택                           │
│     [드롭다운] 2025-05-01 MSC World...       │
├─────────────────────────────────────────────┤
│  2. 객실 구매 정보                           │
│     ┌─────────────┐  ┌─────────────┐   │
│     │ 인테리어    │  │ 발코니        │   │
│     │ 성인: 1.5M  │  │ 성인: 2.5M    │   │
│     │ [수량 입력] │  │ [수량 입력]   │   │
│     └─────────────┘  └─────────────┘   │
├─────────────────────────────────────────────┤
│  3. 대표 예약자 정보                         │
│     이름, 전화번호, 이메일 입력              │
├─────────────────────────────────────────────┤
│  4. 방 배정 및 여행자 명단                   │
│     [+ 여행자 추가]                         │
│     [여권 스캔 버튼]                        │
│     [드래그 앤 드롭으로 방 배정]            │
└─────────────────────────────────────────────┘
```

---

## ✅ 성공 확인 체크리스트

- [ ] 파트너 로그인 성공 (`boss1` / `1101`)
- [ ] 예약 페이지 접근 (`/partner/boss1/reservation/new`)
- [ ] 여행 상품 목록에 "MSC World Europa" 표시
- [ ] 상품 선택 시 인테리어/발코니 요금표 표시
- [ ] 여권 스캔 버튼 클릭 시 파일 선택 다이얼로그 열림
- [ ] 여권 이미지 선택 시 AI 분석 시작
- [ ] 분석 완료 후 여행자 정보 자동 입력

---

## 💡 추가 팁

### 직접 API 테스트

브라우저 콘솔에서 직접 API를 호출해볼 수 있습니다:

```javascript
// 여행 상품 목록 확인
fetch('/api/partner/trips')
  .then(r => r.json())
  .then(data => {
    console.log('Trips:', data.trips);
    console.log('First trip product:', data.trips[0]?.product);
    console.log('Pricing:', data.trips[0]?.product?.MallProductContent?.layout?.pricing);
  });

// 여권 스캔 테스트 (FormData 필요)
const formData = new FormData();
formData.append('file', /* File 객체 */);
fetch('/api/passport/scan', {
  method: 'POST',
  body: formData
})
  .then(r => r.json())
  .then(data => console.log('Passport scan result:', data));
```

### 서버 로그 확인

터미널에서 서버 로그를 확인하면 에러를 빠르게 발견할 수 있습니다:

```bash
# 서버 실행 중인 터미널에서
# 에러 메시지 확인
```

---

**작성일**: 2025-11-22  
**테스트 환경**: `DATABASE_URL_TEST` (포트 3001)





