# 📧 관리자 문의 알림 설정 가이드

> **작성일**: 2025년 1월 28일  
> **목적**: 고객 문의 접수 시 관리자에게 이메일 알림 전송 설정

---

## ✅ 구현 완료

관리자 문의 알림 기능이 구현되었습니다. 고객이 구매 문의나 전화상담을 신청하면 관리자에게 자동으로 이메일이 전송됩니다.

---

## 🔧 환경 변수 설정

### 1. 로컬 개발 환경 (`.env.local`)

프로젝트 루트 디렉토리에 있는 `.env.local` 파일을 열고 다음 변수를 추가합니다:

```bash
# 관리자 문의 알림 이메일 주소
ADMIN_EMAIL=admin@cruisedot.co.kr
```

**참고:**
- `ADMIN_EMAIL`이 설정되지 않으면 `EMAIL_SMTP_USER`를 사용합니다.
- 둘 다 없으면 알림이 전송되지 않습니다 (경고 로그만 출력).

---

### 2. Vercel 프로덕션 환경

Vercel 대시보드에서 환경 변수를 설정합니다:

1. **Vercel 대시보드 접속**: [https://vercel.com/dashboard](https://vercel.com/dashboard)
2. **프로젝트 선택**
3. **Settings → Environment Variables** 이동
4. **새 환경 변수 추가**:
   - Key: `ADMIN_EMAIL`
   - Value: `admin@cruisedot.co.kr` (또는 실제 관리자 이메일 주소)
   - Environment: Production, Preview, Development 모두 선택
5. **Save** 클릭
6. **재배포** (변경 사항 적용)

---

## 📋 이메일 알림 내용

문의가 접수되면 관리자에게 다음 정보가 포함된 이메일이 전송됩니다:

- **문의 ID**: 고유 식별자
- **고객명**: 문의한 고객 이름
- **연락처**: 고객 전화번호
- **여권번호**: 입력한 경우 (선택사항)
- **상품코드**: 문의한 상품 코드
- **상품명**: 문의한 상품 이름
- **문의내용**: 고객이 입력한 메시지 (선택사항)
- **문의 유형**: 전화상담 신청 또는 구매 문의
- **문의 상세보기 링크**: 관리자 패널에서 바로 확인 가능

---

## 🧪 테스트 방법

### 1. 환경 변수 확인

```bash
npm run env:check
```

`ADMIN_EMAIL`이 선택적 환경 변수로 표시되는지 확인합니다.

### 2. 문의 접수 테스트

1. **상품 페이지 접속**: `http://localhost:3000/products/[productCode]`
2. **구매 문의 또는 전화상담 신청**
3. **관리자 이메일 확인**: `ADMIN_EMAIL`로 설정한 이메일 주소의 받은편지함 확인

### 3. 로그 확인

개발 서버 터미널에서 다음 로그를 확인합니다:

```
[Email] 문의 알림 이메일 전송 성공: { to: 'admin@cruisedot.co.kr', inquiryId: 123, messageId: '...' }
```

---

## ⚠️ 주의사항

1. **이메일 전송 실패 시**: 이메일 전송이 실패해도 문의는 정상적으로 저장됩니다. 에러는 로그에만 기록됩니다.

2. **환경 변수 미설정 시**: `ADMIN_EMAIL`이 없으면 `EMAIL_SMTP_USER`를 사용합니다. 둘 다 없으면 알림이 전송되지 않습니다.

3. **SMTP 설정 필요**: 이메일 전송을 위해서는 `EMAIL_SMTP_HOST`, `EMAIL_SMTP_PORT`, `EMAIL_SMTP_USER`, `EMAIL_SMTP_PASSWORD`가 설정되어 있어야 합니다.

---

## 🔍 문제 해결

### 이메일이 전송되지 않는 경우

1. **환경 변수 확인**:
   ```bash
   npm run env:check
   ```

2. **SMTP 설정 확인**:
   - `EMAIL_SMTP_HOST`: `smtp.gmail.com` (Gmail 사용 시)
   - `EMAIL_SMTP_PORT`: `587`
   - `EMAIL_SMTP_USER`: Gmail 주소
   - `EMAIL_SMTP_PASSWORD`: Gmail 앱 비밀번호

3. **로그 확인**:
   - 개발 서버 터미널에서 `[Email]`로 시작하는 로그 확인
   - 에러 메시지 확인

4. **Gmail 설정 확인**:
   - 2단계 인증 활성화 확인
   - 앱 비밀번호 생성 확인
   - 자세한 내용은 `Gmail_SMTP_설정_가이드.md` 참조

---

## ✅ 완료 체크리스트

- [ ] `.env.local`에 `ADMIN_EMAIL` 추가
- [ ] Vercel에 `ADMIN_EMAIL` 환경 변수 추가
- [ ] 문의 접수 테스트 완료
- [ ] 관리자 이메일 수신 확인

---

**작성자:** AI Assistant  
**작성일:** 2025년 1월 28일

