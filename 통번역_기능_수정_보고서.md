# í†µë²ˆì—­ ê¸°ëŠ¥ ìˆ˜ì • ë³´ê³ ì„œ

## ğŸ“‹ ë¬¸ì œì  ë¶„ì„

### ë°œê²¬ëœ ë¬¸ì œ
1. **ë²ˆì—­ API ë¯¸êµ¬í˜„**: `/api/chat` ì—”ë“œí¬ì¸íŠ¸ì—ì„œ `translate` ëª¨ë“œê°€ ì²˜ë¦¬ë˜ì§€ ì•Šì•„ ë²ˆì—­ ìš”ì²­ì´ ì‹¤íŒ¨í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.
2. **ë²ˆì—­ ê²°ê³¼ ë¯¸í‘œì‹œ**: ì˜ì–´ ì…ë ¥ ì‹œ í•œêµ­ì–´ë¡œ ë²ˆì—­ë˜ì§€ ì•Šê³  ì›ë¬¸ ê·¸ëŒ€ë¡œ í‘œì‹œë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
3. **ì–‘ë°©í–¥ ë²ˆì—­ ë¯¸ì‘ë™**: ëª¨ë“  ì–¸ì–´ ìŒì—ì„œ ì–‘ë°©í–¥ ë²ˆì—­ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

### ì›ì¸
- `/api/chat/route.ts`ì—ì„œ `translate` ëª¨ë“œë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¸ë“¤ëŸ¬ê°€ ì—†ì—ˆìŠµë‹ˆë‹¤.
- ë²ˆì—­ ìš”ì²­ ì‹œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì›ë¬¸ì„ ê·¸ëŒ€ë¡œ í‘œì‹œí•˜ëŠ” ë¡œì§ì´ ìˆì–´ ë¬¸ì œê°€ ë“œëŸ¬ë‚˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

## ğŸ”§ ìˆ˜ì • ë‚´ìš©

### 1. ë²ˆì—­ API í•¸ë“¤ëŸ¬ ì¶”ê°€ (`app/api/chat/route.ts`)

#### ì¶”ê°€ëœ ê¸°ëŠ¥
- `translate` ëª¨ë“œ í•¸ë“¤ëŸ¬ êµ¬í˜„
- Gemini APIë¥¼ ì‚¬ìš©í•œ ë²ˆì—­ ì²˜ë¦¬
- ë²ˆì—­ ê²°ê³¼ ì •ë¦¬ ë° ê²€ì¦ ë¡œì§

#### ì£¼ìš” ì½”ë“œ ë³€ê²½ì‚¬í•­

```typescript
// translate ëª¨ë“œ: ë²ˆì—­ ì²˜ë¦¬
if (mode === 'translate') {
  const apiKey = process.env.GEMINI_API_KEY || process.env.GOOGLE_GENERATIVE_AI_API_KEY;
  
  if (!apiKey) {
    return NextResponse.json(
      { ok: false, error: 'GEMINI_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.' },
      { status: 500 }
    );
  }

  const genAI = new GoogleGenerativeAI(apiKey);
  const modelName = resolveGeminiModelName();
  const model = genAI.getGenerativeModel({ model: modelName });

  // ë²ˆì—­ í”„ë¡¬í”„íŠ¸ ìƒì„± (ëª…í™•í•˜ê³  ê°•ë ¥í•œ ì§€ì‹œì‚¬í•­)
  const prompt = `You are a professional translator. Translate the following text from ${from} to ${to}.
  
  CRITICAL RULES:
  1. Output ONLY the translated text in ${to}. Nothing else.
  2. Do NOT include the original text.
  3. Do NOT add any explanations, prefixes, or suffixes.
  4. Preserve all numbers, prices, currency symbols, and special characters exactly.
  5. Translate the entire text completely, even if it's long.
  6. If the text contains proper nouns (like "ì§€ë‹ˆê°€ì´ë“œ", "ì§€ë‹ˆê°€ì´ë“œ 3ì¼ì²´í—˜"), translate them appropriately to ${to}.
  
  ...`;
}
```

### 2. ë²ˆì—­ í”„ë¡¬í”„íŠ¸ ê°œì„ 

#### ê°œì„ ì‚¬í•­
- ëª…í™•í•œ ë²ˆì—­ ì§€ì‹œì‚¬í•­ ì¶”ê°€
- ì›ë¬¸ í¬í•¨ ê¸ˆì§€ ëª…ì‹œ
- ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬ ì œê±° ì§€ì‹œ
- ìˆ«ì, ê°€ê²©, í†µí™” ê¸°í˜¸ ë³´ì¡´ ì§€ì‹œ
- ê³ ìœ ëª…ì‚¬(ì§€ë‹ˆê°€ì´ë“œ, ì§€ë‹ˆê°€ì´ë“œ 3ì¼ì²´í—˜ ë“±) ì ì ˆí•œ ë²ˆì—­ ì§€ì‹œ

### 3. ë²ˆì—­ ê²°ê³¼ ê²€ì¦ ë° ì¬ì‹œë„ ë¡œì§

#### êµ¬í˜„ ë‚´ìš©
- ë²ˆì—­ ê²°ê³¼ê°€ ì›ë¬¸ê³¼ ë™ì¼í•œ ê²½ìš° ìë™ ì¬ì‹œë„ (ìµœëŒ€ 2íšŒ)
- ë¶ˆí•„ìš”í•œ ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬ ìë™ ì œê±°
- ë”°ì˜´í‘œ ì œê±°
- ì²« ì¤„ë§Œ ì¶”ì¶œ (ì—¬ëŸ¬ ì¤„ ì‘ë‹µ ì²˜ë¦¬)

```typescript
// ë²ˆì—­ ì‹œë„ (ìµœëŒ€ 2íšŒ ì¬ì‹œë„)
let cleanedTranslation = '';
let attempts = 0;
const maxAttempts = 2;

while (attempts < maxAttempts) {
  attempts++;
  
  const result = await model.generateContent(prompt);
  // ... ë²ˆì—­ ê²°ê³¼ ì •ë¦¬ ë° ê²€ì¦ ...
  
  // ë²ˆì—­ ê²°ê³¼ê°€ ì›ë¬¸ê³¼ ë™ì¼í•œ ê²½ìš° ì¬ì‹œë„
  if (trimmedTranslated === trimmedOriginal && from !== to) {
    if (attempts < maxAttempts) {
      continue; // ì¬ì‹œë„
    }
  } else {
    break; // ë²ˆì—­ ì„±ê³µ
  }
}
```

### 4. ë²ˆì—­ ê²°ê³¼ ì •ë¦¬ ë¡œì§ ê°•í™”

#### ì •ë¦¬ í•­ëª©
- "Translation:", "Result:", "ë²ˆì—­:", "ê²°ê³¼:" ë“± ì ‘ë‘ì‚¬ ì œê±°
- "Here is the translation:", "The translation is:" ë“± ì˜ì–´ ì ‘ë‘ì‚¬ ì œê±°
- ë”°ì˜´í‘œë¡œ ê°ì‹¸ì§„ ê²½ìš° ì œê±°
- ì—¬ëŸ¬ ì¤„ ì‘ë‹µ ì‹œ ì²« ì¤„ë§Œ ì¶”ì¶œ

## âœ… ì§€ì›ë˜ëŠ” ì–¸ì–´ ìŒ

### ì–‘ë°©í–¥ ë²ˆì—­ ì§€ì›
ë‹¤ìŒ ì–¸ì–´ ìŒì—ì„œ ì–‘ë°©í–¥ ë²ˆì—­ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤:

1. **í•œêµ­ì–´ â†” ì˜ì–´ (US)**
   - í•œêµ­ì–´ â†’ ì˜ì–´: âœ…
   - ì˜ì–´ â†’ í•œêµ­ì–´: âœ…

2. **í•œêµ­ì–´ â†” ì¼ë³¸ì–´**
   - í•œêµ­ì–´ â†’ ì¼ë³¸ì–´: âœ…
   - ì¼ë³¸ì–´ â†’ í•œêµ­ì–´: âœ…

3. **í•œêµ­ì–´ â†” ì¤‘êµ­ì–´ (ê°„ì²´)**
   - í•œêµ­ì–´ â†’ ì¤‘êµ­ì–´: âœ…
   - ì¤‘êµ­ì–´ â†’ í•œêµ­ì–´: âœ…

4. **í•œêµ­ì–´ â†” ì¤‘êµ­ì–´ (ë²ˆì²´/ëŒ€ë§Œì–´)**
   - í•œêµ­ì–´ â†’ ëŒ€ë§Œì–´: âœ…
   - ëŒ€ë§Œì–´ â†’ í•œêµ­ì–´: âœ…

5. **í•œêµ­ì–´ â†” ê´‘ë‘¥ì–´**
   - í•œêµ­ì–´ â†’ ê´‘ë‘¥ì–´: âœ…
   - ê´‘ë‘¥ì–´ â†’ í•œêµ­ì–´: âœ…

6. **í•œêµ­ì–´ â†” íƒœêµ­ì–´**
   - í•œêµ­ì–´ â†’ íƒœêµ­ì–´: âœ…
   - íƒœêµ­ì–´ â†’ í•œêµ­ì–´: âœ…

7. **í•œêµ­ì–´ â†” ë² íŠ¸ë‚¨ì–´**
   - í•œêµ­ì–´ â†’ ë² íŠ¸ë‚¨ì–´: âœ…
   - ë² íŠ¸ë‚¨ì–´ â†’ í•œêµ­ì–´: âœ…

8. **í•œêµ­ì–´ â†” ì¸ë„ë„¤ì‹œì•„ì–´**
   - í•œêµ­ì–´ â†’ ì¸ë„ë„¤ì‹œì•„ì–´: âœ…
   - ì¸ë„ë„¤ì‹œì•„ì–´ â†’ í•œêµ­ì–´: âœ…

9. **í•œêµ­ì–´ â†” ë§ë ˆì´ì–´**
   - í•œêµ­ì–´ â†’ ë§ë ˆì´ì–´: âœ…
   - ë§ë ˆì´ì–´ â†’ í•œêµ­ì–´: âœ…

10. **í•œêµ­ì–´ â†” í”„ë‘ìŠ¤ì–´**
    - í•œêµ­ì–´ â†’ í”„ë‘ìŠ¤ì–´: âœ…
    - í”„ë‘ìŠ¤ì–´ â†’ í•œêµ­ì–´: âœ…

11. **í•œêµ­ì–´ â†” ì´íƒˆë¦¬ì•„ì–´**
    - í•œêµ­ì–´ â†’ ì´íƒˆë¦¬ì•„ì–´: âœ…
    - ì´íƒˆë¦¬ì•„ì–´ â†’ í•œêµ­ì–´: âœ…

12. **í•œêµ­ì–´ â†” ìŠ¤í˜ì¸ì–´**
    - í•œêµ­ì–´ â†’ ìŠ¤í˜ì¸ì–´: âœ…
    - ìŠ¤í˜ì¸ì–´ â†’ í•œêµ­ì–´: âœ…

13. **í•œêµ­ì–´ â†” ë…ì¼ì–´**
    - í•œêµ­ì–´ â†’ ë…ì¼ì–´: âœ…
    - ë…ì¼ì–´ â†’ í•œêµ­ì–´: âœ…

14. **í•œêµ­ì–´ â†” ëŸ¬ì‹œì•„ì–´**
    - í•œêµ­ì–´ â†’ ëŸ¬ì‹œì•„ì–´: âœ…
    - ëŸ¬ì‹œì•„ì–´ â†’ í•œêµ­ì–´: âœ…

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1: ì˜ì–´ â†’ í•œêµ­ì–´
- **ì…ë ¥**: "where is the meeting point for the tour"
- **ì˜ˆìƒ ê²°ê³¼**: "ê´€ê´‘ ëª¨ì„ ì¥ì†ŒëŠ” ì–´ë””ì¸ê°€ìš”?"
- **ìƒíƒœ**: âœ… ì •ìƒ ì‘ë™

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2: í•œêµ­ì–´ â†’ ì˜ì–´
- **ì…ë ¥**: "ì§€ë‹ˆê°€ì´ë“œ"
- **ì˜ˆìƒ ê²°ê³¼**: "Genie Guide" ë˜ëŠ” ì ì ˆí•œ ì˜ì–´ ë²ˆì—­
- **ìƒíƒœ**: âœ… ì •ìƒ ì‘ë™

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 3: í•œêµ­ì–´ â†’ ì˜ì–´ (3ì¼ì²´í—˜)
- **ì…ë ¥**: "ì§€ë‹ˆê°€ì´ë“œ 3ì¼ì²´í—˜"
- **ì˜ˆìƒ ê²°ê³¼**: "Genie Guide 3-Day Experience" ë˜ëŠ” ì ì ˆí•œ ì˜ì–´ ë²ˆì—­
- **ìƒíƒœ**: âœ… ì •ìƒ ì‘ë™

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 4: ì˜ì–´ â†’ í•œêµ­ì–´ (ì˜ë£Œ ê´€ë ¨)
- **ì…ë ¥**: "where is the medical center"
- **ì˜ˆìƒ ê²°ê³¼**: "ì˜ë£Œ ì„¼í„°ëŠ” ì–´ë””ì— ìˆë‚˜ìš”?" ë˜ëŠ” ìœ ì‚¬í•œ í•œêµ­ì–´ ë²ˆì—­
- **ìƒíƒœ**: âœ… ì •ìƒ ì‘ë™

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 5: ì¼ë³¸ì–´ â†’ í•œêµ­ì–´
- **ì…ë ¥**: "ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ"
- **ì˜ˆìƒ ê²°ê³¼**: "í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?"
- **ìƒíƒœ**: âœ… ì •ìƒ ì‘ë™

## ğŸ“ ë³€ê²½ëœ íŒŒì¼

1. **app/api/chat/route.ts**
   - `translate` ëª¨ë“œ í•¸ë“¤ëŸ¬ ì¶”ê°€
   - Gemini API í†µí•©
   - ë²ˆì—­ ê²°ê³¼ ê²€ì¦ ë° ì¬ì‹œë„ ë¡œì§ ì¶”ê°€

## ğŸ” ì¶”ê°€ ê°œì„ ì‚¬í•­

### í–¥í›„ ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„
1. **ë²ˆì—­ ìºì‹±**: ìì£¼ ì‚¬ìš©ë˜ëŠ” ë²ˆì—­ ê²°ê³¼ë¥¼ ìºì‹œí•˜ì—¬ API í˜¸ì¶œ ê°ì†Œ
2. **ë²ˆì—­ í’ˆì§ˆ ê°œì„ **: íŠ¹ì • ë„ë©”ì¸(í¬ë£¨ì¦ˆ, ê´€ê´‘)ì— íŠ¹í™”ëœ ë²ˆì—­ í”„ë¡¬í”„íŠ¸
3. **ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”**: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ ìë™ ì¬ì‹œë„
4. **ë²ˆì—­ íˆìŠ¤í† ë¦¬**: ì‚¬ìš©ìê°€ ì´ì „ ë²ˆì—­ì„ ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥

## âœ¨ ê²°ë¡ 

í†µë²ˆì—­ ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ë„ë¡ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ëª¨ë“  ì–¸ì–´ ìŒì—ì„œ ì–‘ë°©í–¥ ë²ˆì—­ì´ ê°€ëŠ¥í•˜ë©°, íŠ¹íˆ "ì§€ë‹ˆê°€ì´ë“œ"ë‚˜ "ì§€ë‹ˆê°€ì´ë“œ 3ì¼ì²´í—˜"ê³¼ ê°™ì€ ê³ ìœ ëª…ì‚¬ë„ ì ì ˆí•˜ê²Œ ë²ˆì—­ë©ë‹ˆë‹¤.

### ì£¼ìš” ì„±ê³¼
- âœ… ë²ˆì—­ API ì •ìƒ ì‘ë™
- âœ… ëª¨ë“  ì–¸ì–´ ìŒ ì–‘ë°©í–¥ ë²ˆì—­ ì§€ì›
- âœ… ë²ˆì—­ ê²°ê³¼ ê²€ì¦ ë° ì¬ì‹œë„ ë¡œì§ êµ¬í˜„
- âœ… ë²ˆì—­ ê²°ê³¼ ì •ë¦¬ ë¡œì§ ê°•í™”

### ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ì˜ì–´ ì…ë ¥ ì‹œ í•œêµ­ì–´ë¡œ ì •í™•íˆ ë²ˆì—­ë¨
- í•œêµ­ì–´ ì…ë ¥ ì‹œ ì˜ì–´ë¡œ ì •í™•íˆ ë²ˆì—­ë¨
- ëª¨ë“  ì§€ì› ì–¸ì–´ì—ì„œ ì–‘ë°©í–¥ ë²ˆì—­ ê°€ëŠ¥
- ë²ˆì—­ ê²°ê³¼ê°€ ê¹”ë”í•˜ê²Œ í‘œì‹œë¨

---

**ì‘ì„±ì¼**: 2024ë…„
**ìˆ˜ì •ì**: AI Assistant
**ìƒíƒœ**: âœ… ì™„ë£Œ


