# ì •ì•¡ì œ ë¬´ë£Œì²´í—˜ ê¸°ëŠ¥ ì œí•œ ë°±ì—… ë¬¸ì„œ

**ì‘ì„±ì¼**: 2024ë…„ (í˜„ì¬ ìƒíƒœ ê³ ì •)
**ëª©ì **: ì •ì•¡ì œ ë¬´ë£Œì²´í—˜ ë° êµ¬ë… ê¸°ëŠ¥ ì œí•œ ì‚¬í•­ì„ ëª…í™•íˆ ê¸°ë¡í•˜ì—¬ í–¥í›„ ë³€ê²½ ì‹œ ì°¸ê³ 

---

## ğŸ“‹ ê¸°ëŠ¥ ì œí•œ ìš”ì•½

### ë¬´ë£Œ ì²´í—˜ (30% ê¸°ëŠ¥)
- **ê¸°ê°„**: 7ì¼
- **ì‚¬ìš© ê°€ëŠ¥ ê¸°ëŠ¥**: 5ê°œ
- **ì‹œê°ì  í‘œì‹œ**: ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ (ring-4 ring-red-500 ring-offset-2)

### ì •ì•¡ì œ ì™„ë£Œ (50% ê¸°ëŠ¥)
- **ê¸°ê°„**: 1ê°œì›” (100,000ì›)
- **ì‚¬ìš© ê°€ëŠ¥ ê¸°ëŠ¥**: 8ê°œ
- **ì‹œê°ì  í‘œì‹œ**: ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ (ring-4 ring-red-500 ring-offset-2)

---

## âœ… ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥ ëª©ë¡

### ë¬´ë£Œ ì²´í—˜ ì¤‘ ì‚¬ìš© ê°€ëŠ¥ (5ê°œ)

1. **ë‚˜ì˜ íŒë§¤ëª°** (`my-mall`)
   - ê¸°ëŠ¥: ê°œì¸ íŒë§¤ëª° í˜ì´ì§€ ì—´ê¸°
   - êµ¬í˜„: `window.open(\`/\${user.mallUserId || user.phone || partnerId}/shop\`, '_blank')`

2. **ë§í¬ ê´€ë¦¬** (`link-create`)
   - ê¸°ëŠ¥: ì–´í•„ë¦¬ì—ì´íŠ¸ ë§í¬ ìƒì„± ë° ê´€ë¦¬
   - êµ¬í˜„: `router.push(\`\${partnerBase}/links\`)`

3. **ë‚˜ì˜ ê³ ê°ê´€ë¦¬** (`customer-management`)
   - ê¸°ëŠ¥: ê³ ê° ë¦¬ë“œ ê´€ë¦¬, ê³ ê° ìƒì„¸ ì •ë³´ ì¡°íšŒ
   - êµ¬í˜„: `router.push(\`\${partnerBase}/customers\`)`

4. **êµ¬ë§¤ê³ ê° ê´€ë¦¬** (`purchased-customers`)
   - ê¸°ëŠ¥: êµ¬ë§¤ í™•ì •ëœ ê³ ê° ê´€ë¦¬
   - êµ¬í˜„: `router.push(\`\${partnerBase}/purchased-customers\`)`

5. **í”„ë¡œí•„ ìˆ˜ì •** (`profile-edit`)
   - ê¸°ëŠ¥: íŒë§¤ì› í”„ë¡œí•„ ì •ë³´ ìˆ˜ì • (3.3% ìˆ˜ìˆ˜ë£Œ, í†µì¥ì‚¬ë³¸ ë“±ë¡)
   - êµ¬í˜„: `router.push(\`\${partnerBase}/profile\`)`

### ì •ì•¡ì œ ì™„ë£Œ í›„ ì¶”ê°€ ì‚¬ìš© ê°€ëŠ¥ (3ê°œ ì¶”ê°€, ì´ 8ê°œ)

6. **í¬ë£¨ì¦ˆ ê°€ì´ë“œ ë™í–‰ì¸ ë“±ë¡** (`companion-registration`)
   - ê¸°ëŠ¥: í¬ë£¨ì¦ˆ ë™í–‰ì¸ ì •ë³´ ë“±ë¡
   - êµ¬í˜„: `setShowCustomerRegisterModal(true)`

7. **ê³ ê° ê·¸ë£¹ ê´€ë¦¬** (`customer-group-management`)
   - ê¸°ëŠ¥: ê³ ê° ê·¸ë£¹ ìƒì„± ë° ê´€ë¦¬
   - êµ¬í˜„: `router.push(\`\${partnerBase}/customer-groups\`)`

8. **ë‚˜ì˜ SNS í”„ë¡œí•„** (`sns-profile`)
   - ê¸°ëŠ¥: SNS í”„ë¡œí•„ ì •ë³´ ê´€ë¦¬
   - êµ¬í˜„: `router.push(\`\${partnerBase}/sns-profile\`)`

---

## ğŸš« ì œí•œëœ ê¸°ëŠ¥ ëª©ë¡

### ëŒ€ë¦¬ì ì¥ ì „ìš© ê¸°ëŠ¥ (ì •ì•¡ì œ ì‚¬ìš© ë¶ˆê°€)

ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì€ í´ë¦­ ì‹œ **"ëŒ€ë¦¬ì ì¥ë‹˜ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì •ì•¡ì œëŠ” ì“¸ ìˆ˜ ì—†ì–´ìš” ã… ã…  ë‹´ë‹¹ ì ì¥ë‹˜ê³¼ ìƒì˜ í•´ ì£¼ì„¸ìš”"** ë©”ì‹œì§€ í‘œì‹œ:

1. **íŒ€ ê´€ë¦¬** (`team-management`)
   - íŒë§¤ì›ë³„ DB ê´€ë¦¬ í˜„í™©
   - ëœë”©í˜ì´ì§€ ê´€ë¦¬
   - íŒë§¤ì›ë³„ DB ê´€ë¦¬
   - íŒ€ ê´€ë¦¬

2. **ê³„ì•½ì„œ ë³´ë‚´ê¸°** (`contract-invite`)
   - ê³„ì•½ì„œ ì´ˆëŒ€ ë° ì „ì†¡

3. **ë‚˜ì˜ ê³„ì•½ì„œ ë³´ê¸°** (`view-contract`)
   - ë³¸ì¸ì˜ ê³„ì•½ì„œ ì¡°íšŒ

4. **ê¸°íƒ€ ëŒ€ë¦¬ì ì¥ ì „ìš© ê¸°ëŠ¥**
   - `stats-detail`: ìƒì„¸ í†µê³„/ë¶„ì„
   - `report-advanced`: ê³ ê¸‰ ë¦¬í¬íŠ¸
   - `data-export`: ë°ì´í„° ë‹¤ìš´ë¡œë“œ
   - `api-access`: API ì ‘ê·¼
   - `commission-adjust`: ìˆ˜ë‹¹ ì¡°ì •
   - `advanced-settings`: ê³ ê¸‰ ì„¤ì •

### ë§ˆë¹„ì¦ˆ VIP íŒë§¤ì› ì „ìš© ê¸°ëŠ¥ (ì •ì•¡ì œ ì‚¬ìš© ë¶ˆê°€)

í´ë¦­ ì‹œ **"ë§ˆë¹„ì¦ˆ VIP íŒë§¤ì› ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì •ì•¡ì œëŠ” ì“¸ ìˆ˜ ì—†ì–´ìš” ã… ã…  ë‹´ë‹¹ ì ì¥ë‹˜ê³¼ ìƒì˜ í•´ ì£¼ì„¸ìš”"** ë©”ì‹œì§€ í‘œì‹œ:

- í˜„ì¬ ì •ì˜ëœ VIP íŒë§¤ì› ì „ìš© ê¸°ëŠ¥ ì—†ìŒ (í–¥í›„ ì¶”ê°€ ê°€ëŠ¥)

### ë¬´ë£Œ ì²´í—˜ ì¤‘ ì œí•œëœ ê¸°ëŠ¥

í´ë¦­ ì‹œ **"ì§€ê¸ˆì€ ë¬´ë£Œ ì‚¬ìš© ì¤‘ì´ì‹­ë‹ˆë‹¤. ë‹¤ë¥¸ ê¸°ëŠ¥ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš” ã… ã… "** ë©”ì‹œì§€ í‘œì‹œ:

1. **ì˜ˆì•½ ë©”ì‹œì§€ ê´€ë¦¬** (`scheduled-messages`)
2. **ë¬¸ì ë³´ë‚´ê¸°** (`sms-send`)
3. **ê²°ì œ/ì •ì‚°** (`payment-settlement`)
4. **ì„œë¥˜ê´€ë¦¬** (`document-management`)
5. **ìˆ˜ë™ì—¬ê¶Œ ë“±ë¡** (`manual-passport`)
6. **í¬ë£¨ì¦ˆ ê°€ì´ë“œ ë™í–‰ì¸ ë“±ë¡** (`companion-registration`) - ì •ì•¡ì œ ì™„ë£Œ í›„ ì‚¬ìš© ê°€ëŠ¥
7. **ê³ ê° ê·¸ë£¹ ê´€ë¦¬** (`customer-group-management`) - ì •ì•¡ì œ ì™„ë£Œ í›„ ì‚¬ìš© ê°€ëŠ¥
8. **ë‚˜ì˜ SNS í”„ë¡œí•„** (`sns-profile`) - ì •ì•¡ì œ ì™„ë£Œ í›„ ì‚¬ìš© ê°€ëŠ¥

---

## ğŸ¨ UI/UX êµ¬í˜„ ì‚¬í•­

### 1. ë¹ ë¥¸ ë©”ë‰´ ë²„íŠ¼ ìŠ¤íƒ€ì¼

**ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥**:
```tsx
className={`... ${canUseFeatureClient('feature-name', subscriptionInfo) ? 'ring-4 ring-red-500 ring-offset-2' : ''}`}
```

**ì œí•œëœ ê¸°ëŠ¥**:
- `subscriptionInfo`ê°€ ìˆì„ ë•Œ: `button` ìš”ì†Œë¡œ ë Œë”ë§
- í´ë¦­ ì‹œ: ëª¨ë‹¬ ë©”ì‹œì§€ í‘œì‹œ (`FeatureRestrictionModal`)
- `subscriptionInfo`ê°€ ì—†ì„ ë•Œ: `Link` ìš”ì†Œë¡œ ì •ìƒ ë Œë”ë§

### 2. ëª¨ë‹¬ ë©”ì‹œì§€

**êµ¬í˜„ ìœ„ì¹˜**: `app/partner/[partnerId]/dashboard/PartnerDashboard.tsx`

```tsx
const [showFeatureRestrictionModal, setShowFeatureRestrictionModal] = useState(false);
const [restrictionMessage, setRestrictionMessage] = useState<string>('');

// í´ë¦­ í•¸ë“¤ëŸ¬ ì˜ˆì‹œ
onClick={() => {
  if (canUseFeatureClient('feature-name', subscriptionInfo)) {
    // ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ - ì •ìƒ ë™ì‘
    router.push(`${partnerBase}/feature-path`);
  } else {
    // ê¸°ëŠ¥ ì‚¬ìš© ë¶ˆê°€ - ëª¨ë‹¬ í‘œì‹œ
    const message = getFeatureRestrictionMessageClient('feature-name', subscriptionInfo);
    setRestrictionMessage(message);
    setShowFeatureRestrictionModal(true);
  }
}}
```

### 3. ëŒ€ì‹œë³´ë“œ í…Œë§ˆ

**ì •ì•¡ì œ íŒë§¤ì› ëŒ€ì‹œë³´ë“œ**:
- ì œëª©: "ì •ì•¡ì œ ëŒ€ì‹œë³´ë“œ"
- ìƒ‰ìƒ: ë…¸ë€ìƒ‰ ê³„ì—´ (`from-yellow-500 via-yellow-400 to-yellow-600`)
- D-day í‘œì‹œ: ë‚¨ì€ ì¼ìˆ˜ ê³„ì‚° ë° í‘œì‹œ

---

## ğŸ“ ê´€ë ¨ íŒŒì¼

### í•µì‹¬ íŒŒì¼

1. **`lib/subscription-limits.ts`** (ì„œë²„ ì‚¬ì´ë“œ)
   - `canUseFeature()`: ì„œë²„ì—ì„œ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
   - `getSubscriptionInfo()`: êµ¬ë… ì •ë³´ ì¡°íšŒ
   - `getFeatureRestrictionMessage()`: ì œí•œ ë©”ì‹œì§€ ë°˜í™˜

2. **`lib/subscription-limits-client.ts`** (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ)
   - `canUseFeatureClient()`: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
   - `getFeatureRestrictionMessageClient()`: ì œí•œ ë©”ì‹œì§€ ë°˜í™˜
   - `getFeatureTypeClient()`: ê¸°ëŠ¥ íƒ€ì… í™•ì¸ (ëŒ€ë¦¬ì ì¥/VIP íŒë§¤ì›/ì¼ë°˜)

3. **`app/partner/[partnerId]/dashboard/PartnerDashboard.tsx`**
   - ëŒ€ì‹œë³´ë“œ UI êµ¬í˜„
   - ë¹ ë¥¸ ë©”ë‰´ ë²„íŠ¼ ë Œë”ë§
   - ëª¨ë‹¬ ë©”ì‹œì§€ í‘œì‹œ

### ê¸°ëŠ¥ë³„ êµ¬í˜„ ìœ„ì¹˜

- **ê³ ê° ê´€ë¦¬ ì„¹ì…˜**: "ì „ì²´ë³´ê¸°" ë§í¬ ë° ë¦¬ë“œ í•­ëª© í´ë¦­ ì²´í¬
- **ìµœê·¼ íŒë§¤ ì„¹ì…˜**: í´ë¦­ ì‹œ ëª¨ë‹¬ í‘œì‹œ
- **íŒë§¤ì›ë³„ DB ê´€ë¦¬ í˜„í™©**: subscriptionInfo ì²´í¬
- **ëœë”©í˜ì´ì§€ ëª©ë¡**: subscriptionInfo ì²´í¬

---

## ğŸ”’ ì ‘ê·¼ ì œì–´ ë¡œì§

### í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ì²´í¬

```typescript
// ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
if (canUseFeatureClient('feature-name', subscriptionInfo)) {
  // ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥
  router.push('/path');
} else {
  // ê¸°ëŠ¥ ì‚¬ìš© ë¶ˆê°€ - ëª¨ë‹¬ í‘œì‹œ
  const message = getFeatureRestrictionMessageClient('feature-name', subscriptionInfo);
  setRestrictionMessage(message);
  setShowFeatureRestrictionModal(true);
}
```

### ì„œë²„ ì‚¬ì´ë“œ ì²´í¬ (í•„ìš” ì‹œ)

```typescript
import { canUseFeature } from '@/lib/subscription-limits';

const canUse = await canUseFeature(userId, 'feature-name');
if (!canUse) {
  return NextResponse.json({ error: 'ì´ ê¸°ëŠ¥ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' }, { status: 403 });
}
```

---

## ğŸ“ ë©”ì‹œì§€ í…œí”Œë¦¿

### ëŒ€ë¦¬ì ì¥ ì „ìš© ê¸°ëŠ¥
```
ëŒ€ë¦¬ì ì¥ë‹˜ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì •ì•¡ì œëŠ” ì“¸ ìˆ˜ ì—†ì–´ìš” ã… ã…  ë‹´ë‹¹ ì ì¥ë‹˜ê³¼ ìƒì˜ í•´ ì£¼ì„¸ìš”
```

### ë§ˆë¹„ì¦ˆ VIP íŒë§¤ì› ì „ìš© ê¸°ëŠ¥
```
ë§ˆë¹„ì¦ˆ VIP íŒë§¤ì› ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì •ì•¡ì œëŠ” ì“¸ ìˆ˜ ì—†ì–´ìš” ã… ã…  ë‹´ë‹¹ ì ì¥ë‹˜ê³¼ ìƒì˜ í•´ ì£¼ì„¸ìš”
```

### ë¬´ë£Œ ì²´í—˜ ì¤‘ ì œí•œëœ ê¸°ëŠ¥
```
ì§€ê¸ˆì€ ë¬´ë£Œ ì‚¬ìš© ì¤‘ì´ì‹­ë‹ˆë‹¤. ë‹¤ë¥¸ ê¸°ëŠ¥ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš” ã… ã… 
```

### ì •ì•¡ì œ ë§Œë£Œ/ì·¨ì†Œëœ ê²½ìš°
```
ì´ ê¸°ëŠ¥ì€ ì •ì•¡ì œ êµ¬ë… í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
```

---

## âš ï¸ ì¤‘ìš” ì‚¬í•­

1. **ê¸°ëŠ¥ ì¶”ê°€ ì‹œ**: `lib/subscription-limits.ts`ì™€ `lib/subscription-limits-client.ts`ì˜ `allowedFeatures` ë°°ì—´ì— ì¶”ê°€
2. **ëŒ€ë¦¬ì ì¥ ì „ìš© ê¸°ëŠ¥ ì¶”ê°€ ì‹œ**: `branchManagerFeatures` ë°°ì—´ì— ì¶”ê°€
3. **VIP íŒë§¤ì› ì „ìš© ê¸°ëŠ¥ ì¶”ê°€ ì‹œ**: `salesAgentFeatures` ë°°ì—´ì— ì¶”ê°€
4. **UI ë³€ê²½ ì‹œ**: `PartnerDashboard.tsx`ì˜ ë¹ ë¥¸ ë©”ë‰´ ë²„íŠ¼ ë Œë”ë§ ë¡œì§ ìˆ˜ì •
5. **ëª¨ë‹¬ ë©”ì‹œì§€ ë³€ê²½ ì‹œ**: `getFeatureRestrictionMessageClient()` í•¨ìˆ˜ ìˆ˜ì •

---

## ğŸ”„ ë³€ê²½ ì´ë ¥

### í˜„ì¬ ë²„ì „ (ê³ ì •)
- ë¬´ë£Œ ì²´í—˜: 30% (5ê°œ ê¸°ëŠ¥)
- ì •ì•¡ì œ ì™„ë£Œ: 50% (8ê°œ ê¸°ëŠ¥)
- ëª¨ë“  ì œí•œëœ ê¸°ëŠ¥ í´ë¦­ ì‹œ ëª¨ë‹¬ ë©”ì‹œì§€ í‘œì‹œ
- ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥ ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ í‘œì‹œ

---

**ì´ ë¬¸ì„œëŠ” ì •ì•¡ì œ ë¬´ë£Œì²´í—˜ ê¸°ëŠ¥ ì œí•œì˜ í˜„ì¬ ìƒíƒœë¥¼ ë°±ì—…í•œ ê²ƒì…ë‹ˆë‹¤.**
**ê¸°ëŠ¥ ë³€ê²½ ì‹œ ì´ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ì„¸ìš”.**

