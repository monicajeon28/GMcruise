# "ì§€ë‹ˆì•¼ ê°€ì" í‚¤ì›Œë“œ ê²€ìƒ‰ ê¸°ëŠ¥ ì ê²€ ë³´ê³ ì„œ

> **ì‘ì„±ì¼**: 2025-01-23  
> **ë¬¸ì œ**: í˜„ìœ„ì¹˜/ì§€ì •ìœ„ì¹˜ì—ì„œ "ë§›ì§‘" ë“± í‚¤ì›Œë“œ ê²€ìƒ‰ ì‹œ ë„¤ë¹„ê²Œì´ì…˜ë§Œ ì œê³µë˜ê³  ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•ŠìŒ  
> **ëª©ì **: ì›ì¸ íŒŒì•… ë° í•´ê²° ë°©ì•ˆ ì œì‹œ

---

## ğŸ“‹ ëª©ì°¨

1. [ë¬¸ì œ ìƒí™©](#ë¬¸ì œ-ìƒí™©)
2. [ì›ì¸ ë¶„ì„](#ì›ì¸-ë¶„ì„)
3. [í˜„ì¬ ì½”ë“œ êµ¬ì¡°](#í˜„ì¬-ì½”ë“œ-êµ¬ì¡°)
4. [í•´ê²° ë°©ì•ˆ](#í•´ê²°-ë°©ì•ˆ)
5. [êµ¬í˜„ ê³„íš](#êµ¬í˜„-ê³„íš)

---

## ë¬¸ì œ ìƒí™©

### ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

**ì…ë ¥ ì˜ˆì‹œ:**
- "í™ì½©ì—ì„œ ë§›ì§‘"
- "í˜„ìœ„ì¹˜ì—ì„œ ê´€ê´‘ì§€"
- "ë„ì¿„ì—ì„œ ì¹´í˜"

**ê¸°ëŒ€ ë™ì‘:**
- ì£¼ë³€ ë§›ì§‘/ê´€ê´‘ì§€/ì¹´í˜ë¥¼ ë³´ì—¬ì£¼ëŠ” Google Maps ê²€ìƒ‰ ê²°ê³¼ ì§€ë„ê°€ í¼ì³ì ¸ì•¼ í•¨

**ì‹¤ì œ ë™ì‘:**
- ë„¤ë¹„ê²Œì´ì…˜(ê¸¸ì°¾ê¸°) ë§í¬ë§Œ ì œê³µë¨
- "í™ì½©"ì—ì„œ "ë§›ì§‘"ìœ¼ë¡œ ê°€ëŠ” ê¸¸ì°¾ê¸° ë§í¬ê°€ ìƒì„±ë¨
- ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

---

## ì›ì¸ ë¶„ì„

### 1. í‚¤ì›Œë“œ ê°ì§€ ë¡œì§ ë¶€ì¬

**í˜„ì¬ ì½”ë“œ íë¦„:**

```26:57:app/api/chat/route.ts
    // go ëª¨ë“œ: ê²½ë¡œ ì•ˆë‚´
    if (mode === 'go') {
      let messages: ChatMessage[];
      
      if (from && to) {
        // from/toê°€ ì´ë¯¸ íŒŒì‹±ëœ ê²½ìš° ì§ì ‘ ì‚¬ìš© (ë¶ˆí•„ìš”í•œ ë³€í™˜ ì œê±°)
        const origin = { text: from };
        const dest = { text: to };
        const urls = buildAllDirUrls(origin, dest);
        
        messages = [
          { type:'text', text:`í™•ì¸í–ˆì–´ìš”.\nì¶œë°œì§€: ${from}\në„ì°©ì§€: ${to}` },
          {
            type:'map-links',
            title:'ê¸¸ì°¾ê¸°',
            links:[
              { label:'ğŸš— ìë™ì°¨ ê¸¸ì°¾ê¸°', href: urls.driving, kind: 'directions' },
              { label:'ğŸš‡ ëŒ€ì¤‘êµí†µ ê¸¸ì°¾ê¸°', href: urls.transit, kind: 'directions' },
              { label:'ğŸš¶ ë„ë³´ ê¸¸ì°¾ê¸°', href: urls.walking, kind: 'directions' },
            ],
          },
          { type:'text', text:'ìƒˆ ì°½ì—ì„œ ì—´ë ¤ìš”. ì§€ë„ì—ì„œ **ì‹œì‘**ë§Œ ëˆ„ë¥´ì‹œë©´ ë©ë‹ˆë‹¤.' }
        ];
      } else {
        // textì—ì„œ íŒŒì‹± (resolveFromTo ì‚¬ìš©)
        messages = handleDirections(text);
      }
      
      return NextResponse.json({ ok: true, messages });
    }
```

**ë¬¸ì œì :**
- âŒ í‚¤ì›Œë“œ(ë§›ì§‘, ê´€ê´‘ì§€, ì¹´í˜ ë“±) ê°ì§€ ë¡œì§ì´ ì—†ìŒ
- âŒ ëª¨ë“  ì…ë ¥ì„ ê¸¸ì°¾ê¸°(directions)ë¡œ ì²˜ë¦¬
- âŒ ê²€ìƒ‰(search) ê¸°ëŠ¥ì´ í˜¸ì¶œë˜ì§€ ì•ŠìŒ

---

### 2. ê¸°ì¡´ í‚¤ì›Œë“œ ê°ì§€ ì½”ë“œëŠ” ìˆìœ¼ë‚˜ ë¯¸ì‚¬ìš©

**ì¡´ì¬í•˜ëŠ” ì½”ë“œ:**

```120:124:app/api/chat/detect.ts
// ê·¼ì²˜ í‚¤ì›Œë“œ
export const NEARBY_KEYWORDS = ["ìŠ¤íƒ€ë²…ìŠ¤", "ì¹´í˜", "í¸ì˜ì ", "ë§ˆíŠ¸", "market", "ì‹ë‹¹", "ì•½êµ­", "í˜¸í…”"];
export function extractNearbyKeyword(t: string) {
  return NEARBY_KEYWORDS.find(k => t.toLowerCase().includes(k.toLowerCase()));
}
```

**ë¬¸ì œì :**
- âœ… `extractNearbyKeyword()` í•¨ìˆ˜ëŠ” ì¡´ì¬í•¨
- âŒ `app/api/chat/route.ts`ì—ì„œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
- âŒ `handleDirections()`ì—ì„œë„ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ

---

### 3. ê²€ìƒ‰ URL ìƒì„± í•¨ìˆ˜ëŠ” ì¡´ì¬

**ì¡´ì¬í•˜ëŠ” ì½”ë“œ:**

```19:22:lib/maps.ts
export function gmSearchUrl(q: string | LatLng) {
  const val = typeof q === 'string' ? encodeURIComponent(q) : `${q.lat},${lng}`;
  return `https://www.google.com/maps/search/?api=1&query=${val}`;
}
```

**ë¬¸ì œì :**
- âœ… `gmSearchUrl()` í•¨ìˆ˜ëŠ” ì¡´ì¬í•¨
- âŒ í‚¤ì›Œë“œ ê²€ìƒ‰ ì‹œ í˜¸ì¶œë˜ì§€ ì•ŠìŒ

---

## í˜„ì¬ ì½”ë“œ êµ¬ì¡°

### 1. API ë¼ìš°íŠ¸ (`app/api/chat/route.ts`)

```
ì‚¬ìš©ì ì…ë ¥: "í™ì½©ì—ì„œ ë§›ì§‘"
    â†“
mode === 'go' í™•ì¸
    â†“
from && to í™•ì¸
    â†“
ì—†ìœ¼ë©´ â†’ handleDirections(text) í˜¸ì¶œ
    â†“
resolveFromTo("í™ì½©ì—ì„œ ë§›ì§‘") íŒŒì‹±
    â†“
"í™ì½©" â†’ ì¶œë°œì§€
"ë§›ì§‘" â†’ ë„ì°©ì§€ (âŒ ë¬¸ì œ!)
    â†“
ê¸¸ì°¾ê¸° ë§í¬ ìƒì„± (âŒ ê²€ìƒ‰ì´ ì•„ë‹˜!)
```

### 2. í•¸ë“¤ëŸ¬ í•¨ìˆ˜ (`app/api/chat/handlers/directions.ts`)

```4:30:app/api/chat/handlers/directions.ts
export function handleDirections(text: string): ChatMessage[] {
  const parsed = resolveFromTo(text);
  
  if (!parsed) {
    return [{ 
      type:'text', 
      text:'ì…ë ¥ í˜•ì‹ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.\n\nâœ… ì§€ì›ë˜ëŠ” í˜•ì‹:\nâ€¢ "Aì—ì„œ Bê¹Œì§€"\nâ€¢ "Aë¶€í„° Bê¹Œì§€"\nâ€¢ "A â†’ B" (í™”ì‚´í‘œ)\nâ€¢ "A to B" (ì˜ì–´)\nâ€¢ "ë§ˆì´ì• ë¯¸" (ì§€ëª…ë§Œ ì…ë ¥ ì‹œ ê³µí•­â†’í„°ë¯¸ë„ ìë™ ì¶”ë¡ )\n\nğŸ“ ì˜ˆì‹œ:\nâ€¢ "í™ì½© ê³µí•­ì—ì„œ ì¹´ì´íƒ í„°ë¯¸ë„ê¹Œì§€"\nâ€¢ "ë§ˆì´ì• ë¯¸ ê³µí•­ â†’ ë§ˆì´ì• ë¯¸ í¬ë£¨ì¦ˆ í„°ë¯¸ë„"\nâ€¢ "ë§ˆì´ì• ë¯¸" (ìë™ìœ¼ë¡œ ê³µí•­â†’í„°ë¯¸ë„ ê²½ë¡œ ì°¾ê¸°)' 
    }];
  }
  
  const { origin, dest, originText, destText } = parsed;
  const urls = buildAllDirUrls(origin, dest);
  
  return [
    { type:'text', text:`í™•ì¸í–ˆì–´ìš”.\nì¶œë°œì§€: ${originText}\në„ì°©ì§€: ${destText}` },
    {
      type:'map-links',
      title:'ê¸¸ì°¾ê¸°',
      links:[
        { label:'ğŸš— ìë™ì°¨ ê¸¸ì°¾ê¸°', href: urls.driving, kind: 'directions' },
        { label:'ğŸš‡ ëŒ€ì¤‘êµí†µ ê¸¸ì°¾ê¸°', href: urls.transit, kind: 'directions' },
        { label:'ğŸš¶ ë„ë³´ ê¸¸ì°¾ê¸°', href: urls.walking, kind: 'directions' },
      ],
    },
    { type:'text', text:'ìƒˆ ì°½ì—ì„œ ì—´ë ¤ìš”. ì§€ë„ì—ì„œ **ì‹œì‘**ë§Œ ëˆ„ë¥´ì‹œë©´ ë©ë‹ˆë‹¤.' }
  ];
}
```

**ë¬¸ì œì :**
- âŒ í‚¤ì›Œë“œ ê°ì§€ ì—†ìŒ
- âŒ ëª¨ë“  ì…ë ¥ì„ ì¶œë°œì§€/ë„ì°©ì§€ë¡œ íŒŒì‹±
- âŒ ê²€ìƒ‰ ë§í¬ ìƒì„± ì—†ìŒ

---

## í•´ê²° ë°©ì•ˆ

### 1. í‚¤ì›Œë“œ ê°ì§€ ë¡œì§ ì¶”ê°€

**í™•ì¥ëœ í‚¤ì›Œë“œ ëª©ë¡:**
```typescript
const SEARCH_KEYWORDS = [
  "ë§›ì§‘", "ì‹ë‹¹", "restaurant", "food",
  "ê´€ê´‘ì§€", "tourist", "attraction", "sightseeing",
  "ì¹´í˜", "cafe", "coffee",
  "í¸ì˜ì ", "convenience", "store",
  "ë§ˆíŠ¸", "market", "supermarket",
  "ì•½êµ­", "pharmacy", "drugstore",
  "í˜¸í…”", "hotel",
  "ì€í–‰", "bank",
  "ë³‘ì›", "hospital",
  "ì£¼ìœ ì†Œ", "gas station",
  "ATM"
];
```

### 2. ê²€ìƒ‰ vs ê¸¸ì°¾ê¸° êµ¬ë¶„ ë¡œì§

**ë¡œì§ íë¦„:**
```
ì…ë ¥: "í™ì½©ì—ì„œ ë§›ì§‘"
    â†“
í‚¤ì›Œë“œ ê°ì§€: "ë§›ì§‘" ë°œê²¬
    â†“
ì¶œë°œì§€ ì¶”ì¶œ: "í™ì½©"
    â†“
ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±: "í™ì½© ë§›ì§‘" ë˜ëŠ” "ë§›ì§‘ near í™ì½©"
    â†“
gmSearchUrl() í˜¸ì¶œ
    â†“
ê²€ìƒ‰ ë§í¬ ì œê³µ
```

### 3. êµ¬í˜„ ìœ„ì¹˜

**ì˜µì…˜ 1: `handleDirections()` í•¨ìˆ˜ ë‚´ë¶€ ìˆ˜ì •**
- ì¥ì : ê¸°ì¡´ êµ¬ì¡° ìœ ì§€
- ë‹¨ì : í•¨ìˆ˜ ì´ë¦„ê³¼ ê¸°ëŠ¥ì´ ë§ì§€ ì•ŠìŒ

**ì˜µì…˜ 2: ìƒˆë¡œìš´ í•¨ìˆ˜ `handleKeywordSearch()` ìƒì„±**
- ì¥ì : ê´€ì‹¬ì‚¬ ë¶„ë¦¬, ëª…í™•í•œ êµ¬ì¡°
- ë‹¨ì : ì¶”ê°€ í•¨ìˆ˜ í•„ìš”

**ì˜µì…˜ 3: `route.ts`ì—ì„œ ì‚¬ì „ ì²˜ë¦¬**
- ì¥ì : í•¸ë“¤ëŸ¬ í•¨ìˆ˜ëŠ” ìˆœìˆ˜í•˜ê²Œ ìœ ì§€
- ë‹¨ì : ë¼ìš°íŠ¸ íŒŒì¼ì´ ë³µì¡í•´ì§

**ê¶Œì¥: ì˜µì…˜ 2 + ì˜µì…˜ 3 ì¡°í•©**
- `route.ts`ì—ì„œ í‚¤ì›Œë“œ ê°ì§€
- í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ `handleKeywordSearch()` í˜¸ì¶œ
- í‚¤ì›Œë“œê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ `handleDirections()` í˜¸ì¶œ

---

## êµ¬í˜„ ê³„íš

### Phase 1: í‚¤ì›Œë“œ ê°ì§€ í•¨ìˆ˜ ê°œì„ 

**íŒŒì¼:** `app/api/chat/detect.ts`

```typescript
// ê¸°ì¡´ ì½”ë“œ í™•ì¥
export const SEARCH_KEYWORDS = [
  ...NEARBY_KEYWORDS,
  "ë§›ì§‘", "ì‹ë‹¹", "restaurant", "food",
  "ê´€ê´‘ì§€", "tourist", "attraction", "sightseeing",
  "ì€í–‰", "bank",
  "ë³‘ì›", "hospital",
  "ì£¼ìœ ì†Œ", "gas station",
  "ATM"
];

export function extractSearchKeyword(t: string): string | null {
  return SEARCH_KEYWORDS.find(k => t.toLowerCase().includes(k.toLowerCase())) || null;
}

export function isKeywordSearch(text: string): boolean {
  return extractSearchKeyword(text) !== null;
}
```

---

### Phase 2: í‚¤ì›Œë“œ ê²€ìƒ‰ í•¸ë“¤ëŸ¬ ìƒì„±

**íŒŒì¼:** `app/api/chat/handlers/keyword-search.ts` (ì‹ ê·œ)

```typescript
import { gmSearchUrl } from '@/lib/maps';
import { extractSearchKeyword, parseOriginDestination } from '@/app/api/chat/detect';
import type { ChatMessage } from '@/lib/chat-types';

export function handleKeywordSearch(text: string): ChatMessage[] {
  const keyword = extractSearchKeyword(text);
  if (!keyword) {
    return [{ 
      type: 'text', 
      text: 'í‚¤ì›Œë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë§›ì§‘, ê´€ê´‘ì§€, ì¹´í˜ ë“±ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.' 
    }];
  }

  // ì¶œë°œì§€ ì¶”ì¶œ
  const { originText, destText } = parseOriginDestination(text);
  const location = originText || 'í˜„ì¬ ìœ„ì¹˜';
  
  // ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±
  const searchQuery = originText 
    ? `${originText} ${keyword}` 
    : keyword;
  
  const searchUrl = gmSearchUrl(searchQuery);
  
  return [
    { 
      type: 'text', 
      text: `${location} ê·¼ì²˜ **${keyword}** ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.` 
    },
    {
      type: 'map-links',
      title: `ì£¼ë³€ ${keyword} ê²€ìƒ‰`,
      links: [
        { 
          label: `ğŸ” ${location} ê·¼ì²˜ ${keyword} ì°¾ê¸°`, 
          href: searchUrl, 
          kind: 'search' 
        },
      ],
    },
    { 
      type: 'text', 
      text: 'ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìƒˆ ì°½ì—ì„œ ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—´ë¦½ë‹ˆë‹¤.' 
    }
  ];
}
```

---

### Phase 3: ë¼ìš°íŠ¸ ìˆ˜ì •

**íŒŒì¼:** `app/api/chat/route.ts`

```typescript
import { handleKeywordSearch } from './handlers/keyword-search';
import { isKeywordSearch } from '@/app/api/chat/detect';

// go ëª¨ë“œ: ê²½ë¡œ ì•ˆë‚´
if (mode === 'go') {
  let messages: ChatMessage[];
  
  // í‚¤ì›Œë“œ ê²€ìƒ‰ì¸ì§€ í™•ì¸
  if (isKeywordSearch(text)) {
    messages = handleKeywordSearch(text);
  } else if (from && to) {
    // ê¸°ì¡´ ë¡œì§ (ê¸¸ì°¾ê¸°)
    // ...
  } else {
    messages = handleDirections(text);
  }
  
  return NextResponse.json({ ok: true, messages });
}
```

---

## ìƒì„¸ êµ¬í˜„ ì½”ë“œ

### 1. í‚¤ì›Œë“œ ê°ì§€ í•¨ìˆ˜ í™•ì¥

**íŒŒì¼:** `app/api/chat/detect.ts`

```typescript
// ê¸°ì¡´ NEARBY_KEYWORDS í™•ì¥
export const SEARCH_KEYWORDS = [
  "ìŠ¤íƒ€ë²…ìŠ¤", "ì¹´í˜", "í¸ì˜ì ", "ë§ˆíŠ¸", "market", "ì‹ë‹¹", "ì•½êµ­", "í˜¸í…”",
  "ë§›ì§‘", "restaurant", "food", "dining",
  "ê´€ê´‘ì§€", "tourist", "attraction", "sightseeing", "landmark",
  "ì€í–‰", "bank",
  "ë³‘ì›", "hospital", "clinic",
  "ì£¼ìœ ì†Œ", "gas station", "gasoline",
  "ATM", "atm"
];

export function extractSearchKeyword(t: string): string | null {
  const lower = t.toLowerCase();
  return SEARCH_KEYWORDS.find(k => lower.includes(k.toLowerCase())) || null;
}

export function isKeywordSearch(text: string): boolean {
  return extractSearchKeyword(text) !== null;
}
```

---

### 2. í‚¤ì›Œë“œ ê²€ìƒ‰ í•¸ë“¤ëŸ¬

**íŒŒì¼:** `app/api/chat/handlers/keyword-search.ts` (ì‹ ê·œ ìƒì„±)

```typescript
import { gmSearchUrl } from '@/lib/maps';
import { extractSearchKeyword, parseOriginDestination } from '@/app/api/chat/detect';
import type { ChatMessage } from '@/lib/chat-types';

export function handleKeywordSearch(text: string, from?: string, to?: string): ChatMessage[] {
  // í‚¤ì›Œë“œ ì¶”ì¶œ
  const keyword = extractSearchKeyword(text);
  if (!keyword) {
    return [{ 
      type: 'text', 
      text: 'í‚¤ì›Œë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë§›ì§‘, ê´€ê´‘ì§€, ì¹´í˜ ë“±ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.' 
    }];
  }

  // ì¶œë°œì§€ ì¶”ì¶œ (from íŒŒë¼ë¯¸í„° ìš°ì„ , ì—†ìœ¼ë©´ textì—ì„œ íŒŒì‹±)
  let location = from;
  if (!location) {
    const parsed = parseOriginDestination(text);
    location = parsed.originText || 'í˜„ì¬ ìœ„ì¹˜';
  }
  
  // ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±
  // ì˜ˆ: "í™ì½© ë§›ì§‘" ë˜ëŠ” "ë§›ì§‘ near í™ì½©"
  const searchQuery = location && location !== 'í˜„ì¬ ìœ„ì¹˜'
    ? `${location} ${keyword}`
    : keyword;
  
  const searchUrl = gmSearchUrl(searchQuery);
  
  // í‚¤ì›Œë“œ í•œê¸€ í‘œì‹œ
  const keywordDisplay = keyword === 'restaurant' ? 'ë§›ì§‘' :
                        keyword === 'cafe' ? 'ì¹´í˜' :
                        keyword === 'tourist' ? 'ê´€ê´‘ì§€' :
                        keyword;
  
  return [
    { 
      type: 'text', 
      text: `${location} ê·¼ì²˜ **${keywordDisplay}** ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.` 
    },
    {
      type: 'map-links',
      title: `ì£¼ë³€ ${keywordDisplay} ê²€ìƒ‰`,
      links: [
        { 
          label: `ğŸ” ${location} ê·¼ì²˜ ${keywordDisplay} ì°¾ê¸°`, 
          href: searchUrl, 
          kind: 'search' 
        },
      ],
    },
    { 
      type: 'text', 
      text: 'ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìƒˆ ì°½ì—ì„œ ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—´ë¦½ë‹ˆë‹¤. ì§€ë„ì—ì„œ ì—¬ëŸ¬ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.' 
    }
  ];
}
```

---

### 3. ë¼ìš°íŠ¸ ìˆ˜ì •

**íŒŒì¼:** `app/api/chat/route.ts`

```typescript
import { handleKeywordSearch } from './handlers/keyword-search';
import { isKeywordSearch } from '@/app/api/chat/detect';

// go ëª¨ë“œ: ê²½ë¡œ ì•ˆë‚´
if (mode === 'go') {
  let messages: ChatMessage[];
  
  // í‚¤ì›Œë“œ ê²€ìƒ‰ì¸ì§€ í™•ì¸
  if (isKeywordSearch(text)) {
    messages = handleKeywordSearch(text, from, to);
  } else if (from && to) {
    // ê¸°ì¡´ ë¡œì§ (ê¸¸ì°¾ê¸°)
    const origin = { text: from };
    const dest = { text: to };
    const urls = buildAllDirUrls(origin, dest);
    
    messages = [
      { type:'text', text:`í™•ì¸í–ˆì–´ìš”.\nì¶œë°œì§€: ${from}\në„ì°©ì§€: ${to}` },
      {
        type:'map-links',
        title:'ê¸¸ì°¾ê¸°',
        links:[
          { label:'ğŸš— ìë™ì°¨ ê¸¸ì°¾ê¸°', href: urls.driving, kind: 'directions' },
          { label:'ğŸš‡ ëŒ€ì¤‘êµí†µ ê¸¸ì°¾ê¸°', href: urls.transit, kind: 'directions' },
          { label:'ğŸš¶ ë„ë³´ ê¸¸ì°¾ê¸°', href: urls.walking, kind: 'directions' },
        ],
      },
      { type:'text', text:'ìƒˆ ì°½ì—ì„œ ì—´ë ¤ìš”. ì§€ë„ì—ì„œ **ì‹œì‘**ë§Œ ëˆ„ë¥´ì‹œë©´ ë©ë‹ˆë‹¤.' }
    ];
  } else {
    // textì—ì„œ íŒŒì‹± (resolveFromTo ì‚¬ìš©)
    messages = handleDirections(text);
  }
  
  return NextResponse.json({ ok: true, messages });
}
```

---

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: í‚¤ì›Œë“œ ê²€ìƒ‰ (ë§›ì§‘)

**ì…ë ¥:** "í™ì½©ì—ì„œ ë§›ì§‘"

**ê¸°ëŒ€ ê²°ê³¼:**
```
í™•ì¸ ë©”ì‹œì§€: "í™ì½© ê·¼ì²˜ **ë§›ì§‘** ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤."
ë§í¬: "ğŸ” í™ì½© ê·¼ì²˜ ë§›ì§‘ ì°¾ê¸°" (Google Maps ê²€ìƒ‰)
ì•ˆë‚´: "ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìƒˆ ì°½ì—ì„œ ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—´ë¦½ë‹ˆë‹¤."
```

**ê²€ìƒ‰ URL:** `https://www.google.com/maps/search/?api=1&query=í™ì½©%20ë§›ì§‘`

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: í‚¤ì›Œë“œ ê²€ìƒ‰ (ê´€ê´‘ì§€)

**ì…ë ¥:** "ë„ì¿„ì—ì„œ ê´€ê´‘ì§€"

**ê¸°ëŒ€ ê²°ê³¼:**
```
í™•ì¸ ë©”ì‹œì§€: "ë„ì¿„ ê·¼ì²˜ **ê´€ê´‘ì§€** ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤."
ë§í¬: "ğŸ” ë„ì¿„ ê·¼ì²˜ ê´€ê´‘ì§€ ì°¾ê¸°" (Google Maps ê²€ìƒ‰)
```

**ê²€ìƒ‰ URL:** `https://www.google.com/maps/search/?api=1&query=ë„ì¿„%20ê´€ê´‘ì§€`

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì¼ë°˜ ê¸¸ì°¾ê¸° (í‚¤ì›Œë“œ ì—†ìŒ)

**ì…ë ¥:** "í™ì½© ê³µí•­ì—ì„œ ì¹´ì´íƒ í„°ë¯¸ë„ê¹Œì§€"

**ê¸°ëŒ€ ê²°ê³¼:**
```
í™•ì¸ ë©”ì‹œì§€: "í™•ì¸í–ˆì–´ìš”.\nì¶œë°œì§€: í™ì½© ê³µí•­\në„ì°©ì§€: ì¹´ì´íƒ í„°ë¯¸ë„"
ë§í¬: ìë™ì°¨, ëŒ€ì¤‘êµí†µ, ë„ë³´ ê¸¸ì°¾ê¸° (3ê°œ)
```

---

## ì˜ˆìƒ íš¨ê³¼

### ê°œì„  ì „
- âŒ "í™ì½©ì—ì„œ ë§›ì§‘" â†’ ê¸¸ì°¾ê¸° ë§í¬ë§Œ ì œê³µ
- âŒ ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ
- âŒ ì‚¬ìš©ì í˜¼ë€

### ê°œì„  í›„
- âœ… "í™ì½©ì—ì„œ ë§›ì§‘" â†’ ì£¼ë³€ ë§›ì§‘ ê²€ìƒ‰ ê²°ê³¼ ì œê³µ
- âœ… Google Mapsì—ì„œ ì—¬ëŸ¬ ë§›ì§‘ í™•ì¸ ê°€ëŠ¥
- âœ… ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

---

## ìš°ì„ ìˆœìœ„

### ğŸ”´ ìµœìš°ì„  (ì¦‰ì‹œ êµ¬í˜„)

1. **í‚¤ì›Œë“œ ê°ì§€ í•¨ìˆ˜ í™•ì¥** (30ë¶„)
   - `SEARCH_KEYWORDS` ëª©ë¡ í™•ì¥
   - `isKeywordSearch()` í•¨ìˆ˜ ì¶”ê°€

2. **í‚¤ì›Œë“œ ê²€ìƒ‰ í•¸ë“¤ëŸ¬ ìƒì„±** (1ì‹œê°„)
   - `handleKeywordSearch()` í•¨ìˆ˜ êµ¬í˜„
   - ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„± ë¡œì§

3. **ë¼ìš°íŠ¸ ìˆ˜ì •** (30ë¶„)
   - í‚¤ì›Œë“œ ê²€ìƒ‰ ë¶„ê¸° ì¶”ê°€
   - ê¸°ì¡´ ë¡œì§ê³¼ í†µí•©

**ì´ ì˜ˆìƒ ì‹œê°„:** 2ì‹œê°„

---

## ê²°ë¡ 

### ë¬¸ì œ ì›ì¸

1. âŒ **í‚¤ì›Œë“œ ê°ì§€ ë¡œì§ ë¶€ì¬**: "ë§›ì§‘", "ê´€ê´‘ì§€" ë“± í‚¤ì›Œë“œë¥¼ ê°ì§€í•˜ì§€ ì•ŠìŒ
2. âŒ **ê²€ìƒ‰ vs ê¸¸ì°¾ê¸° êµ¬ë¶„ ì—†ìŒ**: ëª¨ë“  ì…ë ¥ì„ ê¸¸ì°¾ê¸°ë¡œ ì²˜ë¦¬
3. âŒ **ê²€ìƒ‰ URL ë¯¸ì‚¬ìš©**: `gmSearchUrl()` í•¨ìˆ˜ëŠ” ìˆìœ¼ë‚˜ í˜¸ì¶œë˜ì§€ ì•ŠìŒ

### í•´ê²° ë°©ì•ˆ

1. âœ… **í‚¤ì›Œë“œ ê°ì§€ ë¡œì§ ì¶”ê°€**: `isKeywordSearch()` í•¨ìˆ˜ êµ¬í˜„
2. âœ… **í‚¤ì›Œë“œ ê²€ìƒ‰ í•¸ë“¤ëŸ¬ ìƒì„±**: `handleKeywordSearch()` í•¨ìˆ˜ êµ¬í˜„
3. âœ… **ë¼ìš°íŠ¸ ìˆ˜ì •**: í‚¤ì›Œë“œ ê²€ìƒ‰ ë¶„ê¸° ì¶”ê°€

### ì˜ˆìƒ íš¨ê³¼

- âœ… "ë§›ì§‘", "ê´€ê´‘ì§€" ë“± í‚¤ì›Œë“œ ì…ë ¥ ì‹œ ì£¼ë³€ ê²€ìƒ‰ ê²°ê³¼ ì œê³µ
- âœ… Google Mapsì—ì„œ ì—¬ëŸ¬ ê²°ê³¼ í™•ì¸ ê°€ëŠ¥
- âœ… ì‚¬ìš©ì ê²½í—˜ ëŒ€í­ ê°œì„ 

---

**ì‘ì„±ì**: AI Assistant  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-01-23


