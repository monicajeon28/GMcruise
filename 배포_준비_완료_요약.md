# 🚀 Vercel 배포 준비 완료 요약

## ✅ 완료된 작업

### 1. 코드 최적화
- ✅ 카카오톡 알림톡 기능 제거 (유료 기능 제거)
- ✅ 구매고객 목록 페이지네이션 추가 (50개씩)
- ✅ DB 인덱스 추가 (대시보드 통계 쿼리 최적화)
- ✅ 환경변수 검증 스크립트 작성

### 2. 문서 작성
- ✅ `docs/Vercel_배포_가이드.md` - 상세 배포 가이드
- ✅ `docs/배포_체크리스트.md` - 배포 전/후 체크리스트
- ✅ `docs/알리고_API_설정_가이드.md` - 대리점장/판매원용 설정 가이드

## 📋 배포 전 필수 작업

### 1. Vercel 환경변수 설정 (최우선)

Vercel 대시보드 → Settings → Environment Variables에서 설정:

```
GEMINI_API_KEY=your_gemini_api_key
GOOGLE_DRIVE_CLIENT_ID=your_google_drive_client_id
GOOGLE_DRIVE_CLIENT_SECRET=your_google_drive_client_secret
DATABASE_URL=postgresql://user:password@host:port/database
NEXT_PUBLIC_BASE_URL=https://your-domain.vercel.app
```

### 2. 프로덕션 DB 인덱스 적용

프로덕션 데이터베이스에 연결하여 다음 SQL 실행:

```bash
# psql로 연결
psql $DATABASE_URL

# 인덱스 적용
\i prisma/migrations/add_dashboard_stats_indexes.sql
```

또는 직접 SQL 실행:

```sql
CREATE INDEX IF NOT EXISTS "idx_affiliate_lead_manager_created" 
ON "AffiliateLead"("managerId", "createdAt");

CREATE INDEX IF NOT EXISTS "idx_affiliate_lead_agent_created" 
ON "AffiliateLead"("agentId", "createdAt");

CREATE INDEX IF NOT EXISTS "idx_affiliate_sale_manager_created" 
ON "AffiliateSale"("managerId", "createdAt");

CREATE INDEX IF NOT EXISTS "idx_affiliate_sale_agent_created" 
ON "AffiliateSale"("agentId", "createdAt");
```

### 3. Git 커밋 및 푸시

```bash
git add .
git commit -m "배포 준비: 인덱스 추가, 페이지네이션 개선, 카카오톡 제거"
git push origin main
```

## 🚀 배포 실행

### 방법 1: Git 푸시 (권장)
```bash
git push origin main
```
Vercel이 자동으로 감지하여 배포 시작

### 방법 2: Vercel CLI
```bash
vercel --prod
```

## ✅ 배포 후 확인사항

1. **빌드 로그 확인**
   - Vercel 대시보드 → Deployments → Build Logs
   - ✅ 빌드 성공 확인

2. **기본 동작 확인**
   - 홈페이지 접속
   - 로그인 기능
   - 대리점장 대시보드 접속

3. **주요 기능 확인**
   - 어필리에이트 기능
   - 고객 관리 (페이지네이션 확인)
   - 구매 관리

4. **성능 확인**
   - 대시보드 통계 로딩 속도
   - 구매고객 목록 페이지네이션 동작

5. **인덱스 적용 확인**
   ```sql
   \d+ "AffiliateLead"
   \d+ "AffiliateSale"
   ```

## 📝 배포 후 작업

- [ ] 대리점장/판매원에게 알리고 설정 가이드 공유
  - 파일: `docs/알리고_API_설정_가이드.md`

## 🔧 문제 발생 시

1. **빌드 실패**
   - 환경변수 확인
   - Vercel 로그 확인

2. **런타임 에러**
   - 데이터베이스 연결 확인
   - API 키 유효성 확인

3. **성능 저하**
   - 인덱스 적용 확인
   - 데이터베이스 쿼리 로그 확인

## 📚 참고 문서

- 상세 배포 가이드: `docs/Vercel_배포_가이드.md`
- 배포 체크리스트: `docs/배포_체크리스트.md`
- 알리고 설정 가이드: `docs/알리고_API_설정_가이드.md`

---

**준비 완료! 이제 배포를 진행하세요! 🚀**



