# 판매원/대리점장 여권 요청 링크 테스트 가이드

**작성일**: 2025년 1월 28일

---

## 🎯 테스트 위치

### 방법 1: 대시보드에서 접근 (추천) ⭐

1. **판매원/대리점장 로그인**
   - 파트너 모드로 로그인
   - 본인의 `mallUserId`로 로그인 (예: `boss1`, `user1`)

2. **대시보드 접근**
   - 로그인 후 자동으로 대시보드로 이동
   - URL: `/partner/[본인의mallUserId]/dashboard`
   - 예: `http://localhost:3001/partner/boss1/dashboard`

3. **여권 요청 관리 메뉴 클릭**
   - 대시보드 메인 화면의 카드 메뉴에서
   - **"여권 요청 관리"** 카드 클릭 (파란색 배경)
   - 또는 직접 URL 입력: `/partner/[본인의mallUserId]/passport-requests`

---

### 방법 2: 직접 URL 접근

**URL 형식**:
```
http://localhost:3001/partner/[본인의mallUserId]/passport-requests
```

**예시**:
- 판매원: `http://localhost:3001/partner/user1/passport-requests`
- 대리점장: `http://localhost:3001/partner/boss1/passport-requests`

---

## 📋 테스트 시나리오

### 시나리오 1: 빠른 링크 생성 테스트 ⚡

**목표**: "여권 요청 링크" 버튼으로 빠르게 링크 생성

**단계**:

1. **여권 요청 관리 페이지 접근**
   ```
   /partner/[본인의mallUserId]/passport-requests
   ```

2. **고객 목록 확인**
   - 테이블에 고객 목록이 표시됩니다
   - 상태가 "대기중"인 고객이 있으면 좋습니다

3. **"여권 요청 링크" 버튼 클릭**
   - 고객 행의 "작업" 열에서 초록색 버튼 클릭
   - 버튼 텍스트: "여권 요청 링크"

4. **모달 확인**
   - 모달이 열리면 다음이 표시되어야 합니다:
     - 링크 입력창 (읽기 전용)
     - "복사" 버튼
     - 메시지 텍스트 영역 (수정 가능)
     - "메시지 복사" 버튼

5. **메시지 확인**
   - 기본 메시지가 자동으로 생성되어 있어야 합니다:
     ```
     안녕하세요 [고객명]님,

     여권 정보 제출을 위해 아래 링크를 클릭해주세요.

     [여권 제출 링크]

     감사합니다.
     ```

6. **복사 테스트**
   - "메시지 복사" 버튼 클릭
   - 성공 메시지 확인: "메시지가 클립보드에 복사되었습니다."
   - 텍스트 에디터에 붙여넣기하여 내용 확인

7. **메시지 수정 테스트**
   - 텍스트 영역에서 메시지 수정
   - 수정 후 다시 "메시지 복사" 클릭
   - 수정된 내용이 복사되는지 확인

8. **링크 복사 테스트**
   - "복사" 버튼 클릭 (링크만 복사)
   - 링크가 올바르게 복사되는지 확인

9. **목록 새로고침 확인**
   - 모달 닫기
   - 고객 목록에서 해당 고객의 상태가 "확인 중"으로 변경되었는지 확인

---

### 시나리오 2: 재요청 테스트 🔄

**목표**: 이미 요청한 고객에게도 다시 링크 생성 가능한지 확인

**단계**:

1. **이미 요청한 고객 찾기**
   - 상태가 "확인 중"인 고객 선택

2. **"여권 요청 링크" 버튼 클릭**
   - 버튼이 표시되는지 확인 (이전에는 숨겨졌지만 이제는 항상 표시됨)
   - 버튼 클릭

3. **새 링크 생성 확인**
   - 새로운 링크가 생성되는지 확인
   - 이전 링크와 다른 토큰인지 확인

---

### 시나리오 3: 검색 기능 테스트 🔍

**목표**: 고객을 빠르게 찾을 수 있는지 확인

**단계**:

1. **검색창에 고객명 입력**
   - 상단 검색창에 고객명 입력
   - 실시간으로 필터링되는지 확인

2. **검색창에 전화번호 입력**
   - 전화번호 일부 입력
   - 해당 고객이 필터링되는지 확인

3. **검색 결과에서 링크 생성**
   - 검색된 고객의 "여권 요청 링크" 버튼 클릭
   - 정상 작동하는지 확인

---

### 시나리오 4: 기존 "링크 생성" 기능 유지 확인 ✅

**목표**: 기존 수동 입력 폼이 정상 작동하는지 확인

**단계**:

1. **"링크 생성" 버튼 클릭**
   - 파란색 "링크 생성" 버튼 클릭
   - (상태가 "대기중"인 고객에게만 표시됨)

2. **템플릿 선택**
   - 드롭다운에서 템플릿 선택 가능한지 확인

3. **메시지 수정**
   - 템플릿 내용이 자동 입력되는지 확인
   - 메시지 수정 가능한지 확인

4. **링크 생성**
   - "링크 생성하기" 버튼 클릭
   - 링크와 메시지가 생성되는지 확인

---

## ✅ 체크리스트

### 기본 기능
- [ ] 여권 요청 관리 페이지 접근 가능
- [ ] 고객 목록이 표시됨
- [ ] 검색 기능 작동
- [ ] "여권 요청 링크" 버튼 표시
- [ ] "링크 생성" 버튼 표시 (대기중 고객만)

### 여권 요청 링크 기능
- [ ] 버튼 클릭 시 모달 열림
- [ ] 링크가 자동 생성됨
- [ ] 기본 메시지가 자동 생성됨
- [ ] 링크 복사 버튼 작동
- [ ] 메시지 복사 버튼 작동
- [ ] 메시지 수정 가능
- [ ] 모달 닫기 작동
- [ ] 목록 새로고침 후 상태 변경 확인

### 재요청 기능
- [ ] 이미 요청한 고객에게도 버튼 표시
- [ ] 재요청 시 새 링크 생성
- [ ] 재요청 시 상태 업데이트

### 기존 기능 유지
- [ ] "링크 생성" 버튼 작동
- [ ] 템플릿 선택 가능
- [ ] 만료 시간 설정 가능
- [ ] 수동 메시지 입력 가능

---

## 🐛 문제 발생 시 확인 사항

### 1. 페이지 접근 불가
- **확인**: 로그인이 되어 있는지
- **확인**: `mallUserId`가 올바른지
- **확인**: URL이 정확한지

### 2. 고객 목록이 비어있음
- **확인**: 본인에게 할당된 고객이 있는지
- **확인**: 관리자 패널에서 고객이 생성되었는지

### 3. "여권 요청 링크" 버튼이 작동하지 않음
- **확인**: 브라우저 콘솔에 에러가 있는지
- **확인**: 네트워크 탭에서 API 호출이 실패했는지
- **확인**: 고객이 User와 연결되어 있는지

### 4. 링크가 생성되지 않음
- **확인**: API 응답 확인 (네트워크 탭)
- **확인**: 에러 메시지 확인
- **확인**: 고객의 전화번호가 올바른지

---

## 📱 실제 테스트 환경

### 로컬 개발 환경
```
URL: http://localhost:3001/partner/[mallUserId]/passport-requests
```

### 프로덕션 환경
```
URL: https://www.cruisedot.co.kr/partner/[mallUserId]/passport-requests
```

---

## 🔗 관련 페이지

- **대시보드**: `/partner/[mallUserId]/dashboard`
- **여권 요청 관리**: `/partner/[mallUserId]/passport-requests`
- **고객 관리**: `/partner/[mallUserId]/customers`

---

## 💡 테스트 팁

1. **테스트 계정 준비**
   - 판매원 계정: `user1` (또는 다른 판매원 ID)
   - 대리점장 계정: `boss1` (또는 다른 대리점장 ID)

2. **테스트 고객 준비**
   - 관리자 패널에서 테스트 고객 생성
   - 해당 판매원/대리점장에게 할당

3. **브라우저 개발자 도구 활용**
   - F12로 개발자 도구 열기
   - Console 탭: 에러 확인
   - Network 탭: API 호출 확인

---

**마지막 업데이트**: 2025년 1월 28일


