# 크루즈가이드 지니 안정 버전 보호 가이드

## 📌 안정 버전 정보

- **태그명**: `v1.0.0-genie-stable`
- **생성일**: 2025-11-23
- **상태**: ✅ 모든 기능 정상 작동, 온보딩 완전 차단 완료

## 🔒 보호된 기능

다음 기능들은 절대 수정되면 안 됩니다:

### 1. 온보딩 페이지 완전 차단
- **파일**: `app/onboarding/page.tsx`
- **기능**: 모든 접근을 크루즈몰(`/`)로 리다이렉트
- **중요성**: 고객이 온보딩 페이지를 볼 수 없도록 완전히 차단

### 2. 로그아웃 후 크루즈몰 이동
- **파일**: 
  - `components/LogoutButton.tsx`
  - `app/page.tsx`
  - `app/api/auth/logout/route.ts`
- **기능**: 로그아웃 후 항상 크루즈몰(`/`)로 이동, 온보딩으로 절대 이동하지 않음
- **중요성**: 로그아웃 시 온보딩으로 튕기는 것을 완전히 방지

### 3. 로그인 후 온보딩 리다이렉트 차단
- **파일**: `app/login/page.tsx`
- **기능**: 로그인 성공 후 온보딩으로 가려는 시도 차단
- **중요성**: 로그인 후 온보딩으로 자동 이동하는 것을 방지

### 4. 동면 고객 페이지 온보딩 차단
- **파일**: `app/dormant/page.tsx`
- **기능**: 온보딩 버튼 클릭 시 크루즈몰로 이동
- **중요성**: 동면 고객이 온보딩으로 가는 것을 방지

## 🛡️ 보호 메커니즘

### 1. Git 태그 백업
```bash
# 태그 확인
git tag -l "v1.0.0-genie-stable"

# 태그로 복원 (필요시)
git checkout v1.0.0-genie-stable -- app/onboarding/page.tsx
```

### 2. 보호 스크립트 실행
```bash
# 보호된 파일 변경 확인
./scripts/protect-genie-stable.sh
```

### 3. 수동 확인
보호된 파일을 수정하기 전에 반드시 다음을 확인하세요:
1. 변경 사항이 크루즈가이드 지니의 안정성에 영향을 주지 않는지
2. 온보딩으로 리다이렉트하는 로직이 추가되지 않는지
3. 로그아웃 후 크루즈몰로 이동하는 로직이 유지되는지

## ⚠️ 주의사항

1. **온보딩 페이지는 절대 고객에게 보여지면 안 됩니다**
   - 모든 접근을 크루즈몰로 리다이렉트해야 합니다
   - `app/onboarding/page.tsx`는 항상 크루즈몰로 리다이렉트해야 합니다

2. **로그아웃은 항상 크루즈몰로 이동해야 합니다**
   - 에러가 발생해도 크루즈몰로 이동해야 합니다
   - 온보딩으로 절대 이동하지 않아야 합니다

3. **로그인 후 온보딩으로 자동 이동하는 것을 방지해야 합니다**
   - 로그인 API에서 `next` 파라미터가 `/onboarding`이면 차단해야 합니다
   - 로그인 페이지에서도 온보딩 리다이렉트를 차단해야 합니다

## 🔄 복원 방법

보호된 파일이 실수로 변경된 경우:

```bash
# 1. 보호 스크립트로 변경 확인
./scripts/protect-genie-stable.sh

# 2. 특정 파일 복원
git checkout v1.0.0-genie-stable -- app/onboarding/page.tsx

# 3. 모든 보호된 파일 복원
git checkout v1.0.0-genie-stable -- app/onboarding/page.tsx components/LogoutButton.tsx app/page.tsx app/login/page.tsx app/dormant/page.tsx
```

## 📝 변경 이력

- **2025-11-23**: 안정 버전 태그 생성, 온보딩 완전 차단 완료
- **2025-11-23**: 로그아웃 후 크루즈몰 이동 보장
- **2025-11-23**: 로그인 후 온보딩 리다이렉트 차단

