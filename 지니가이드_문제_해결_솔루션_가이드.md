# ğŸ”§ ì§€ë‹ˆê°€ì´ë“œ ë¬¸ì œ í•´ê²° ì†”ë£¨ì…˜ ê°€ì´ë“œ

> **ì‘ì„±ì¼**: 2025ë…„ 1ì›” 28ì¼  
> **ëª©ì **: ë°œê²¬ëœ ëª¨ë“  ë¬¸ì œì ì— ëŒ€í•œ êµ¬ì²´ì ì¸ í•´ê²° ë°©ë²• ì œì‹œ  
> **ëŒ€ìƒ**: ê°œë°œì ë° ê¸°ìˆ  ë‹´ë‹¹ì

---

## ğŸ“‹ ëª©ì°¨

1. [ê¸´ê¸‰ ë¬¸ì œ í•´ê²° (Critical)](#1-ê¸´ê¸‰-ë¬¸ì œ-í•´ê²°-critical)
2. [ì¤‘ìš” ë¬¸ì œ í•´ê²° (Important)](#2-ì¤‘ìš”-ë¬¸ì œ-í•´ê²°-important)
3. [ê¸°ëŠ¥ë³„ í•´ê²° ë°©ë²•](#3-ê¸°ëŠ¥ë³„-í•´ê²°-ë°©ë²•)
4. [í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ê°€ì´ë“œ](#4-í™˜ê²½-ë³€ìˆ˜-ì„¤ì •-ê°€ì´ë“œ)
5. [ë°ì´í„°ë² ì´ìŠ¤ ë¬¸ì œ í•´ê²°](#5-ë°ì´í„°ë² ì´ìŠ¤-ë¬¸ì œ-í•´ê²°)
6. [API ì—°ê²° ë¬¸ì œ í•´ê²°](#6-api-ì—°ê²°-ë¬¸ì œ-í•´ê²°)
7. [ë¹ ë¥¸ ì°¸ì¡° ê°€ì´ë“œ](#7-ë¹ ë¥¸-ì°¸ì¡°-ê°€ì´ë“œ)

---

## 1. ê¸´ê¸‰ ë¬¸ì œ í•´ê²° (Critical)

### ğŸ”´ ë¬¸ì œ 1: í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ìœ¼ë¡œ ì¸í•œ ê¸°ëŠ¥ ì¤‘ë‹¨

#### ì¦ìƒ
- AI ì±„íŒ… ê¸°ëŠ¥ ì‘ë™ ì•ˆ í•¨
- ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨
- Google Drive íŒŒì¼ ì¡°íšŒ ì‹¤íŒ¨
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

#### í•´ê²° ë°©ë²•

##### 1ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ í™•ì¸

```bash
# í™˜ê²½ ë³€ìˆ˜ í™•ì¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
npm run env:check

# ë˜ëŠ” ìˆ˜ë™ í™•ì¸
node scripts/check-env.js
```

##### 2ë‹¨ê³„: Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

1. **Vercel ëŒ€ì‹œë³´ë“œ ì ‘ì†**
   - https://vercel.com/dashboard
   - í”„ë¡œì íŠ¸ ì„ íƒ

2. **Settings â†’ Environment Variables ì´ë™**

3. **í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€**

   **ë°ì´í„°ë² ì´ìŠ¤**:
   ```
   DATABASE_URL=postgresql://user:password@host:port/database?sslmode=require
   ```

   **Gemini API**:
   ```
   GEMINI_API_KEY=your_gemini_api_key_here
   ```
   ë˜ëŠ”
   ```
   GOOGLE_GENERATIVE_AI_API_KEY=your_gemini_api_key_here
   ```

   **Google Drive**:
   ```
   GOOGLE_DRIVE_SERVICE_ACCOUNT_EMAIL=your-service-account@project.iam.gserviceaccount.com
   GOOGLE_DRIVE_SERVICE_ACCOUNT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
   ```

4. **í™˜ê²½ ë³€ìˆ˜ ì ìš©**
   - Production, Preview, Development ëª¨ë‘ ì„ íƒ
   - Save í´ë¦­
   - ì¬ë°°í¬ í•„ìš”

##### 3ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ ì‹œ ìš°ì•„í•œ ì—ëŸ¬ ì²˜ë¦¬

**íŒŒì¼**: `lib/gemini.ts`

```typescript
// ìˆ˜ì • ì „
const GEMINI_API_KEY = process.env.GEMINI_API_KEY || process.env.GOOGLE_GENERATIVE_AI_API_KEY;
if (!GEMINI_API_KEY) {
  throw new Error('Missing GEMINI_API_KEY');
}

// ìˆ˜ì • í›„
const GEMINI_API_KEY = process.env.GEMINI_API_KEY || process.env.GOOGLE_GENERATIVE_AI_API_KEY;
if (!GEMINI_API_KEY) {
  console.error('[Gemini] GEMINI_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
  // ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì—ëŸ¬ throw
  if (process.env.NODE_ENV === 'development') {
    throw new Error('Missing GEMINI_API_KEY');
  }
  // í”„ë¡œë•ì…˜ì—ì„œëŠ” null ë°˜í™˜í•˜ì—¬ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬
  return null;
}
```

**íŒŒì¼**: `lib/google-drive.ts`

```typescript
// ìˆ˜ì • ì „
if (!rawPrivateKey) {
  throw new Error('Google Drive Private Key ì„¤ì • ì˜¤ë¥˜');
}

// ìˆ˜ì • í›„
if (!rawPrivateKey) {
  console.error('[GoogleDrive] Private Keyê°€ í™˜ê²½ë³€ìˆ˜ì— ì—†ìŠµë‹ˆë‹¤.');
  if (process.env.NODE_ENV === 'development') {
    throw new Error('Google Drive Private Key ì„¤ì • ì˜¤ë¥˜');
  }
  // í”„ë¡œë•ì…˜ì—ì„œëŠ” ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ë°˜í™˜
  return {
    ok: false,
    error: 'íŒŒì¼ ì—…ë¡œë“œ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.'
  };
}
```

##### 4ë‹¨ê³„: í…ŒìŠ¤íŠ¸

```bash
# ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜ í™•ì¸
npm run env:check

# ë¹Œë“œ í…ŒìŠ¤íŠ¸
npm run build

# ë°°í¬ í›„ í™•ì¸
# Vercel ëŒ€ì‹œë³´ë“œ â†’ Deployments â†’ Logs í™•ì¸
```

---

### ğŸ”´ ë¬¸ì œ 2: ê´€ë¦¬ì ë¡œê·¸ì¸ ì¸ì¦ ë¶ˆì¼ì¹˜

#### ì¦ìƒ
- ë¡œê·¸ì¸ì€ ì„±ê³µí•˜ì§€ë§Œ ê´€ë¦¬ì íŒ¨ë„ ì ‘ê·¼ ë¶ˆê°€
- "ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì" ì˜¤ë¥˜
- Prisma í´ë¼ì´ì–¸íŠ¸ ëª¨ë“ˆ ì°¾ê¸° ì‹¤íŒ¨

#### í•´ê²° ë°©ë²•

##### 1ë‹¨ê³„: ê´€ë¦¬ì ê³„ì • í™•ì¸

```bash
# ê´€ë¦¬ì ê³„ì • í™•ì¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
npx tsx scripts/check-admin.ts

# ë˜ëŠ” Prisma Studio ì‚¬ìš©
npx prisma studio
# User í…Œì´ë¸”ì—ì„œ ê´€ë¦¬ì ê³„ì • í™•ì¸
```

**í™•ì¸ ì‚¬í•­**:
- ì „í™”ë²ˆí˜¸: `01024958013` ë˜ëŠ” `01038609161` (í•˜ì´í”ˆ ì—†ì´)
- role: `admin`
- ë¹„ë°€ë²ˆí˜¸: ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

##### 2ë‹¨ê³„: ì¸ì¦ í™•ì¸ API í…ŒìŠ¤íŠ¸

**ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ**:
```javascript
fetch('/api/admin/auth-check', { credentials: 'include' })
  .then(r => r.json())
  .then(data => console.log('ì¸ì¦ ìƒíƒœ:', data));
```

**ì˜ˆìƒ ê²°ê³¼**:
```json
{
  "ok": true,
  "authenticated": true,
  "user": {
    "id": 1,
    "name": "ê´€ë¦¬ì",
    "role": "admin",
    "phone": "01024958013"
  }
}
```

##### 3ë‹¨ê³„: ì „í™”ë²ˆí˜¸ ì •ê·œí™” í™•ì¸

**íŒŒì¼**: `app/api/admin/auth-check/route.ts`

```typescript
// ìˆ˜ì • ì „
const isAuthorized = user.phone === '01024958013' || user.phone === '01038609161';

// ìˆ˜ì • í›„ (ì´ë¯¸ ìˆ˜ì • ì™„ë£Œë¡œ ë¬¸ì„œí™”ë¨)
// ì „í™”ë²ˆí˜¸ ì •ê·œí™” (ë¡œê·¸ì¸ ì‹œì™€ ë™ì¼í•˜ê²Œ ì²˜ë¦¬)
const normalizedPhone = user.phone?.replace(/[-\s]/g, '') || '';

// 01024958013 ë˜ëŠ” 01038609161ë§Œ ì ‘ê·¼ í—ˆìš© (ì •ê·œí™”ëœ ì „í™”ë²ˆí˜¸ë¡œ ë¹„êµ)
const isAuthorized = normalizedPhone === '01024958013' || normalizedPhone === '01038609161';
```

##### 4ë‹¨ê³„: Prisma í´ë¼ì´ì–¸íŠ¸ í™•ì¸

**íŒŒì¼**: `next.config.mjs`

```javascript
// í™•ì¸: Prisma í´ë¼ì´ì–¸íŠ¸ê°€ ì œì™¸ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
outputFileTracingExcludes: {
  '*': [
    // ... ë‹¤ë¥¸ ì œì™¸ í•­ëª©ë“¤
    // 'node_modules/.prisma/**', // âš ï¸ ì´ ì¤„ì´ ì£¼ì„ ì²˜ë¦¬ë˜ì–´ ìˆì–´ì•¼ í•¨
  ],
}
```

**íŒŒì¼**: `vercel.json`

```json
{
  "buildCommand": "npm run build",
  "installCommand": "npm install",
  "build": {
    "env": {
      "PRISMA_GENERATE_SKIP_AUTOINSTALL": "false"
    }
  }
}
```

##### 5ë‹¨ê³„: ì„¸ì…˜ ì¿ í‚¤ í™•ì¸

**ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬**:
1. F12 â†’ Application íƒ­ â†’ Cookies
2. `cg.sid.v2` ì¿ í‚¤ í™•ì¸
3. ì¿ í‚¤ ê°’ì´ ìˆëŠ”ì§€ í™•ì¸

**ë¬¸ì œê°€ ìˆë‹¤ë©´**:
- ì¿ í‚¤ê°€ ì—†ìœ¼ë©´ ë¡œê·¸ì¸ ì‹¤íŒ¨
- ì¿ í‚¤ê°€ ìˆì§€ë§Œ ì¸ì¦ ì‹¤íŒ¨ë©´ ì„¸ì…˜ DB ë¬¸ì œ ê°€ëŠ¥

##### 6ë‹¨ê³„: Vercel ë°°í¬ í›„ í™•ì¸

1. **Vercel ëŒ€ì‹œë³´ë“œ â†’ Deployments â†’ ìµœì‹  ë°°í¬ â†’ Logs**
2. **Prisma í´ë¼ì´ì–¸íŠ¸ ê´€ë ¨ ì˜¤ë¥˜ í™•ì¸**
3. **ì—ëŸ¬ê°€ ìˆë‹¤ë©´**:
   ```bash
   # ë¡œì»¬ì—ì„œ Prisma ì¬ìƒì„±
   npx prisma generate
   
   # ì»¤ë°‹ ë° í‘¸ì‹œ
   git add .
   git commit -m "fix: Prisma client regeneration"
   git push
   ```

---

### ğŸ”´ ë¬¸ì œ 3: ê²°ì œ ì‹œìŠ¤í…œ ë¯¸ì™„ì„±

#### ì¦ìƒ
- ê²°ì œ í˜ì´ì§€ì—ì„œ "TODO" ì£¼ì„ í‘œì‹œ
- ì›°ì»´í˜ì´ë¨¼ì¸  ê²°ì œ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì•ˆ ë¨
- ê²°ì œ ê¸°ëŠ¥ ì™„ì „ ì‚¬ìš© ë¶ˆê°€

#### í•´ê²° ë°©ë²•

##### 1ë‹¨ê³„: ì›°ì»´í˜ì´ë¨¼ì¸  API ë¬¸ì„œ í™•ì¸

1. **ì›°ì»´í˜ì´ë¨¼ì¸  ê°œë°œì ì„¼í„° ì ‘ì†**
   - https://developers.welcomepayments.com
   - API ë¬¸ì„œ í™•ì¸

2. **í•„ìˆ˜ ì •ë³´ í™•ì¸**
   - MID (Merchant ID)
   - ì¸ì¦ MID / ë¹„ì¸ì¦ MID
   - MID ë¹„ë°€ë²ˆí˜¸
   - ê²°ì œ í˜ì´ì§€ URL

##### 2ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**Vercel í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€**:
```
NEXT_PUBLIC_WELCOME_PAY_URL=https://pay.welcomepayments.com/payment
PG_MID_AUTH=your_auth_mid
PG_MID_NON_AUTH=your_non_auth_mid
PG_MID_PASSWORD=your_mid_password
```

##### 3ë‹¨ê³„: ê²°ì œ í˜ì´ì§€ ìˆ˜ì •

**íŒŒì¼**: `app/payment/page.tsx`

```typescript
// ìˆ˜ì • ì „
// TODO: ì›°ì»´í˜ì´ë¨¼ì¸  ê²°ì œ í˜ì´ì§€ URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

// ìˆ˜ì • í›„
const handlePayment = async () => {
  try {
    // 1. ê²°ì œ ìš”ì²­ API í˜¸ì¶œ
    const response = await fetch('/api/payment/request', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        amount: totalAmount,
        orderId: orderId,
        // ... ê¸°íƒ€ ê²°ì œ ì •ë³´
      }),
    });

    const data = await response.json();

    if (!data.ok) {
      alert('ê²°ì œ ìš”ì²­ ì‹¤íŒ¨: ' + data.error);
      return;
    }

    // 2. ì›°ì»´í˜ì´ë¨¼ì¸  ê²°ì œ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    const paymentUrl = process.env.NEXT_PUBLIC_WELCOME_PAY_URL;
    if (!paymentUrl) {
      alert('ê²°ì œ ì„œë¹„ìŠ¤ ì„¤ì • ì˜¤ë¥˜');
      return;
    }

    // ê²°ì œ ì •ë³´ë¥¼ URL íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
    const params = new URLSearchParams({
      mid: process.env.PG_MID_AUTH || '',
      orderId: data.orderId,
      amount: data.amount.toString(),
      // ... ê¸°íƒ€ í•„ìˆ˜ íŒŒë¼ë¯¸í„°
    });

    window.location.href = `${paymentUrl}?${params.toString()}`;
  } catch (error) {
    console.error('ê²°ì œ ìš”ì²­ ì˜¤ë¥˜:', error);
    alert('ê²°ì œ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  }
};
```

##### 4ë‹¨ê³„: ê²°ì œ ì½œë°± ì²˜ë¦¬

**íŒŒì¼**: `app/api/payment/callback/route.ts`

```typescript
export async function POST(req: Request) {
  try {
    const body = await req.json();
    
    // ì›°ì»´í˜ì´ë¨¼ì¸ ì—ì„œ ì „ë‹¬ëœ ê²°ì œ ê²°ê³¼ í™•ì¸
    const { orderId, status, amount, transactionId } = body;

    // ê²°ì œ ì„±ê³µ ì—¬ë¶€ í™•ì¸
    if (status === 'success') {
      // ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸
      await prisma.order.update({
        where: { orderId },
        data: {
          status: 'paid',
          paidAt: new Date(),
          transactionId,
        },
      });

      return NextResponse.json({
        ok: true,
        message: 'ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.',
      });
    } else {
      // ê²°ì œ ì‹¤íŒ¨ ì²˜ë¦¬
      return NextResponse.json({
        ok: false,
        error: 'ê²°ì œê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
      }, { status: 400 });
    }
  } catch (error) {
    console.error('ê²°ì œ ì½œë°± ì˜¤ë¥˜:', error);
    return NextResponse.json({
      ok: false,
      error: 'ê²°ì œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
    }, { status: 500 });
  }
}
```

##### 5ë‹¨ê³„: ê²°ì œ í”Œë¡œìš° í…ŒìŠ¤íŠ¸

1. **í…ŒìŠ¤íŠ¸ ê²°ì œ ì§„í–‰**
   - í…ŒìŠ¤íŠ¸ MID ì‚¬ìš©
   - í…ŒìŠ¤íŠ¸ ì¹´ë“œ ë²ˆí˜¸ ì‚¬ìš©

2. **ì„±ê³µ ì¼€ì´ìŠ¤ í™•ì¸**
   - ê²°ì œ ì„±ê³µ ì‹œ ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸ í™•ì¸
   - ê²°ì œ ì™„ë£Œ í˜ì´ì§€ í‘œì‹œ í™•ì¸

3. **ì‹¤íŒ¨ ì¼€ì´ìŠ¤ í™•ì¸**
   - ê²°ì œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ í™•ì¸
   - ì¬ì‹œë„ ë¡œì§ í™•ì¸

---

## 2. ì¤‘ìš” ë¬¸ì œ í•´ê²° (Important)

### ğŸŸ¡ ë¬¸ì œ 4: ì²´í¬ë¦¬ìŠ¤íŠ¸ localStorage ì‚¬ìš©

#### í•´ê²° ë°©ë²•

##### 1ë‹¨ê³„: API í™•ì¸

**API ì—”ë“œí¬ì¸íŠ¸ í™•ì¸**:
- `GET /api/checklist` - ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
- `POST /api/checklist` - í•­ëª© ì¶”ê°€
- `PUT /api/checklist/[id]` - í•­ëª© ìˆ˜ì •
- `DELETE /api/checklist/[id]` - í•­ëª© ì‚­ì œ

##### 2ë‹¨ê³„: í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ìˆ˜ì •

**íŒŒì¼**: `app/checklist/page.tsx`

```typescript
// ìˆ˜ì • ì „
const [items, setItems] = useState(() => {
  const saved = localStorage.getItem('checklist');
  return saved ? JSON.parse(saved) : [];
});

// ìˆ˜ì • í›„
const [items, setItems] = useState([]);
const [loading, setLoading] = useState(true);

// ì´ˆê¸° ë¡œë“œ ì‹œ ì„œë²„ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
useEffect(() => {
  const fetchItems = async () => {
    try {
      const response = await fetch('/api/checklist');
      const data = await response.json();
      if (data.ok) {
        setItems(data.items || []);
      }
    } catch (error) {
      console.error('ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);
    } finally {
      setLoading(false);
    }
  };
  fetchItems();
}, []);

// í•­ëª© ì¶”ê°€
const addItem = async (item: ChecklistItem) => {
  try {
    const response = await fetch('/api/checklist', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(item),
    });
    const data = await response.json();
    if (data.ok) {
      setItems([...items, data.item]);
    }
  } catch (error) {
    console.error('í•­ëª© ì¶”ê°€ ì˜¤ë¥˜:', error);
  }
};

// í•­ëª© ìˆ˜ì •
const updateItem = async (id: number, updates: Partial<ChecklistItem>) => {
  try {
    const response = await fetch(`/api/checklist/${id}`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(updates),
    });
    const data = await response.json();
    if (data.ok) {
      setItems(items.map(item => item.id === id ? data.item : item));
    }
  } catch (error) {
    console.error('í•­ëª© ìˆ˜ì • ì˜¤ë¥˜:', error);
  }
};

// í•­ëª© ì‚­ì œ
const deleteItem = async (id: number) => {
  try {
    const response = await fetch(`/api/checklist/${id}`, {
      method: 'DELETE',
    });
    const data = await response.json();
    if (data.ok) {
      setItems(items.filter(item => item.id !== id));
    }
  } catch (error) {
    console.error('í•­ëª© ì‚­ì œ ì˜¤ë¥˜:', error);
  }
};
```

##### 3ë‹¨ê³„: AI Tool Calling ì—°ë™

**íŒŒì¼**: `app/api/chat/route.ts`

```typescript
import { GoogleGenerativeAI } from '@google/generative-ai';

const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY!);
const model = genAI.getGenerativeModel({ 
  modelName: 'gemini-2.0-flash-exp',
  tools: [
    {
      functionDeclarations: [
        {
          name: 'add_checklist_item',
          description: 'ì²´í¬ë¦¬ìŠ¤íŠ¸ì— í•­ëª© ì¶”ê°€',
          parameters: {
            type: 'object',
            properties: {
              item: {
                type: 'string',
                description: 'ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© ì´ë¦„'
              },
              category: {
                type: 'string',
                description: 'í•­ëª© ì¹´í…Œê³ ë¦¬'
              }
            },
            required: ['item']
          }
        }
      ]
    }
  ]
});

// AI ì‘ë‹µ ì²˜ë¦¬
const result = await model.generateContent(messages);
const response = result.response;

// Function Calling ê²°ê³¼ ì²˜ë¦¬
if (response.functionCalls) {
  for (const call of response.functionCalls) {
    if (call.name === 'add_checklist_item') {
      const { item, category } = call.args;
      // ì²´í¬ë¦¬ìŠ¤íŠ¸ API í˜¸ì¶œ
      await fetch('/api/checklist', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ item, category }),
      });
    }
  }
}
```

---

### ğŸŸ¡ ë¬¸ì œ 5: AI ì±„íŒ… ìŠ¤íŠ¸ë¦¬ë° ë¯¸êµ¬í˜„

#### í•´ê²° ë°©ë²•

##### 1ë‹¨ê³„: ìŠ¤íŠ¸ë¦¬ë° API í™•ì¸

**íŒŒì¼**: `app/api/chat/stream/route.ts` í™•ì¸

##### 2ë‹¨ê³„: í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ìˆ˜ì •

**íŒŒì¼**: `app/chat/page.tsx` (ë˜ëŠ” í•´ë‹¹ ì±„íŒ… ì»´í¬ë„ŒíŠ¸)

```typescript
// ìˆ˜ì • ì „
const response = await fetch('/api/chat', {
  method: 'POST',
  body: JSON.stringify({ text, mode }),
});
const data = await response.json();
setMessages([...messages, data.message]);

// ìˆ˜ì • í›„
const handleStreamingResponse = async (text: string, mode: string) => {
  try {
    const response = await fetch('/api/chat/stream', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ text, mode }),
    });

    if (!response.body) return;

    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let fullText = '';

    // ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì¶”ê°€
    const streamingMessage = {
      type: 'text',
      text: '',
      isStreaming: true,
    };
    setMessages([...messages, streamingMessage]);

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;

      const chunk = decoder.decode(value);
      const lines = chunk.split('\n');

      for (const line of lines) {
        if (line.startsWith('data: ')) {
          const data = JSON.parse(line.slice(6));
          if (data.text) {
            fullText += data.text;
            // ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
            setMessages(prev => {
              const updated = [...prev];
              updated[updated.length - 1] = {
                ...streamingMessage,
                text: fullText,
              };
              return updated;
            });
          }
        }
      }
    }

    // ìŠ¤íŠ¸ë¦¬ë° ì™„ë£Œ
    setMessages(prev => {
      const updated = [...prev];
      updated[updated.length - 1] = {
        ...streamingMessage,
        text: fullText,
        isStreaming: false,
      };
      return updated;
    });
  } catch (error) {
    console.error('ìŠ¤íŠ¸ë¦¬ë° ì˜¤ë¥˜:', error);
  }
};
```

---

### ğŸŸ¡ ë¬¸ì œ 6: ë””ë²„ê·¸ ë¡œê·¸ ì •ë¦¬

#### í•´ê²° ë°©ë²•

##### 1ë‹¨ê³„: ë¡œê±° ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©

**íŒŒì¼**: `lib/logger.ts` (ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸)

```typescript
// lib/logger.ts
const isDev = process.env.NODE_ENV === 'development';

export const logger = {
  log: (...args: any[]) => {
    if (isDev) {
      console.log(...args);
    }
  },
  warn: (...args: any[]) => {
    if (isDev) {
      console.warn(...args);
    }
  },
  error: (...args: any[]) => {
    // ì—ëŸ¬ëŠ” í•­ìƒ ì¶œë ¥
    console.error(...args);
  },
  debug: (...args: any[]) => {
    if (isDev) {
      console.debug(...args);
    }
  },
};
```

##### 2ë‹¨ê³„: console.log êµì²´

**ì „ì²´ í”„ë¡œì íŠ¸ì—ì„œ**:
```bash
# console.log ì°¾ê¸°
grep -r "console\.log" app/ --include="*.ts" --include="*.tsx" | wc -l

# ìˆ˜ë™ìœ¼ë¡œ êµì²´
# console.log â†’ logger.log
# console.warn â†’ logger.warn
# console.error â†’ logger.error (ì—ëŸ¬ëŠ” ìœ ì§€)
```

##### 3ë‹¨ê³„: next.config.mjs í™•ì¸

**íŒŒì¼**: `next.config.mjs`

```javascript
// ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
compiler: {
  removeConsole: process.env.NODE_ENV === 'production' ? {
    exclude: ['error'], // console.errorëŠ” ìœ ì§€
  } : false,
}
```

---

## 3. ê¸°ëŠ¥ë³„ í•´ê²° ë°©ë²•

### 3.1 Google Drive íŒŒì¼ ì—…ë¡œë“œ ë¬¸ì œ

#### ì¦ìƒ
- íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨
- "Google Drive Private Key ì„¤ì • ì˜¤ë¥˜" ë©”ì‹œì§€

#### í•´ê²° ë°©ë²•

1. **í™˜ê²½ ë³€ìˆ˜ í™•ì¸**
   ```bash
   echo $GOOGLE_DRIVE_SERVICE_ACCOUNT_EMAIL
   echo $GOOGLE_DRIVE_SERVICE_ACCOUNT_PRIVATE_KEY
   ```

2. **Private Key í˜•ì‹ í™•ì¸**
   - `-----BEGIN PRIVATE KEY-----`ë¡œ ì‹œì‘
   - `-----END PRIVATE KEY-----`ë¡œ ë
   - ì¤„ë°”ê¿ˆ ë¬¸ì `\n` í¬í•¨

3. **Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   - Private Keyë¥¼ ë”°ì˜´í‘œë¡œ ê°ì‹¸ê¸°
   - ì¤„ë°”ê¿ˆ ë¬¸ì `\n` ì´ìŠ¤ì¼€ì´í”„

---

### 3.2 Gemini API ì˜¤ë¥˜

#### ì¦ìƒ
- AI ì±„íŒ… ì‘ë™ ì•ˆ í•¨
- "GEMINI_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤" ë©”ì‹œì§€

#### í•´ê²° ë°©ë²•

1. **API í‚¤ í™•ì¸**
   - Google AI Studioì—ì„œ API í‚¤ ë°œê¸‰
   - https://aistudio.google.com/apikey

2. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   ```
   GEMINI_API_KEY=your_api_key_here
   ```

3. **API í‚¤ ìœ íš¨ì„± í™•ì¸**
   ```bash
   curl "https://generativelanguage.googleapis.com/v1beta/models?key=YOUR_API_KEY"
   ```

---

## 4. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ê°€ì´ë“œ

### 4.1 í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

```bash
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL=postgresql://user:password@host:port/database?sslmode=require

# Gemini API
GEMINI_API_KEY=your_gemini_api_key_here

# Google Drive
GOOGLE_DRIVE_SERVICE_ACCOUNT_EMAIL=your-service-account@project.iam.gserviceaccount.com
GOOGLE_DRIVE_SERVICE_ACCOUNT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
```

### 4.2 Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

1. **Vercel ëŒ€ì‹œë³´ë“œ ì ‘ì†**
2. **í”„ë¡œì íŠ¸ ì„ íƒ**
3. **Settings â†’ Environment Variables**
4. **ë³€ìˆ˜ ì¶”ê°€ ë° ì €ì¥**
5. **ì¬ë°°í¬**

---

## 5. ë°ì´í„°ë² ì´ìŠ¤ ë¬¸ì œ í•´ê²°

### 5.1 Prisma í´ë¼ì´ì–¸íŠ¸ ì˜¤ë¥˜

#### í•´ê²° ë°©ë²•

```bash
# Prisma í´ë¼ì´ì–¸íŠ¸ ì¬ìƒì„±
npx prisma generate

# ë§ˆì´ê·¸ë ˆì´ì…˜ í™•ì¸
npx prisma migrate status

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸
npx prisma db pull
```

### 5.2 ì—°ê²° ë¬¸ìì—´ í™•ì¸

```bash
# DATABASE_URL í˜•ì‹ í™•ì¸
echo $DATABASE_URL

# í˜•ì‹: postgresql://user:password@host:port/database?sslmode=require
```

---

## 6. API ì—°ê²° ë¬¸ì œ í•´ê²°

### 6.1 ì™¸ë¶€ API ì˜¤ë¥˜

#### Gemini API
```bash
# API í‚¤ í…ŒìŠ¤íŠ¸
curl "https://generativelanguage.googleapis.com/v1beta/models?key=YOUR_API_KEY"
```

#### Google Drive API
```bash
# ì„œë¹„ìŠ¤ ê³„ì • í™•ì¸
# Google Cloud Console â†’ IAM & Admin â†’ Service Accounts
```

### 6.2 ë‚´ë¶€ API ì˜¤ë¥˜

```bash
# API ë¼ìš°íŠ¸ í™•ì¸
ls -la app/api/

# íŠ¹ì • API í…ŒìŠ¤íŠ¸
curl http://localhost:3000/api/health
```

---

## 7. ë¹ ë¥¸ ì°¸ì¡° ê°€ì´ë“œ

### 7.1 ë¬¸ì œ í•´ê²° ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
- [ ] Prisma í´ë¼ì´ì–¸íŠ¸ ì¬ìƒì„±
- [ ] API í‚¤ ìœ íš¨ì„± í™•ì¸
- [ ] Vercel ë°°í¬ ë¡œê·¸ í™•ì¸
- [ ] ë¸Œë¼ìš°ì € ì½˜ì†” ì˜¤ë¥˜ í™•ì¸

### 7.2 ìœ ìš©í•œ ëª…ë ¹ì–´

```bash
# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
npm run env:check

# ë¹Œë“œ í…ŒìŠ¤íŠ¸
npm run build

# íƒ€ì… ì²´í¬
npm run typecheck

# Prisma ìŠ¤íŠœë””ì˜¤
npx prisma studio

# ê´€ë¦¬ì ê³„ì • í™•ì¸
npx tsx scripts/check-admin.ts
```

### 7.3 ë””ë²„ê¹… íŒ

1. **Vercel ë¡œê·¸ í™•ì¸**
   - Vercel ëŒ€ì‹œë³´ë“œ â†’ Deployments â†’ Logs

2. **ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬**
   - F12 â†’ Console íƒ­
   - F12 â†’ Network íƒ­

3. **ë¡œì»¬ í…ŒìŠ¤íŠ¸**
   ```bash
   npm run dev
   ```

---

**ì‘ì„±ì¼**: 2025ë…„ 1ì›” 28ì¼  
**ë²„ì „**: 1.0  
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: ë¬¸ì œ í•´ê²° í›„

