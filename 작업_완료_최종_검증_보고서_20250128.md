# μ‘μ—… μ™„λ£ μµμΆ… κ²€μ¦ λ³΄κ³ μ„

> **μ‘μ„±μΌ**: 2025λ…„ 1μ›” 28μΌ  
> **κ²€μ¦ λ‚΄μ©**: μ§€κΈκΉμ§€ μ‘μ—…ν• λ¨λ“  μμ •μ‚¬ν•­ μµμΆ… κ²€μ¦

---

## β… μ™„λ£λ μ‘μ—… λ©λ΅

### 1. β… λ§ν¬ μƒμ„± μ‹ μ¤‘λ³µ μ²΄ν¬ λ΅μ§ μμ •
- **νμΌ**: `lib/affiliate/auto-setup.ts`
- **μμ •**: `undefined` κ°’ μ κ±°, λ…ν™•ν• μ΅°κ±΄λ¬Έ μ‚¬μ©
- **κ²€μ¦**: β… μ™„λ£

### 2. β… λ§ν¬ μ½”λ“ μ¶©λ λ°©μ§€ λ΅μ§ μ¶”κ°€
- **νμΌ**: `lib/affiliate/auto-setup.ts`
- **μμ •**: `randomBytes(4)` μ‚¬μ©, μµλ€ 10λ² μ‹λ„, μ¶©λ μ²΄ν¬
- **κ²€μ¦**: β… μ™„λ£

### 3. β… λλ”© νμ΄μ§€ slug μ¤‘λ³µ μ²΄ν¬ μ¶”κ°€
- **νμΌ**: `lib/affiliate/auto-setup.ts`
- **μμ •**: `LandingPage.slug` μ¤‘λ³µ μ²΄ν¬, μ¤‘λ³µ μ‹ μλ™ μ•μ „ν• slug μƒμ„±
- **κ²€μ¦**: β… μ™„λ£

### 4. β… μ¤ν‚¤λ§ λ¶μΌμΉ μμ •
- **νμΌ**: `lib/affiliate/auto-setup.ts`
- **μμ •**: `SharedLandingPage` β†’ `LandingPage` + `SharedLandingPage` κ΄€κ³„ μ„¤μ •
- **κ²€μ¦**: β… μ™„λ£

### 5. β… μλ™ μ„¤μ • νΈλμ­μ… μ²λ¦¬ κ°μ„ 
- **νμΌ**: `app/api/admin/affiliate/profiles/route.ts`
- **μμ •**: μλ™ μ„¤μ •μ„ νΈλμ­μ… λ‚΄μ—μ„ μ‹¤ν–‰, μ‹¤ν¨ μ‹ λ΅¤λ°±
- **κ²€μ¦**: β… μ™„λ£

### 6. β… νΈλμ­μ… ν΄λΌμ΄μ–ΈνΈ μ „λ‹¬ λ¬Έμ  μμ •
- **νμΌ**: `lib/affiliate/auto-setup.ts`
- **μμ •**: νΈλμ­μ… ν΄λΌμ΄μ–ΈνΈλ¥Ό μ„ νƒμ  νλΌλ―Έν„°λ΅ λ°›λ„λ΅ λ³€κ²½
- **κ²€μ¦**: β… μ™„λ£

### 7. β… λ€λ¦¬μ μ¥-νλ§¤μ› κ΄€κ³„ μΊμ‹± μµμ ν™”
- **νμΌ**: `lib/affiliate/relation-cache.ts` (μ‹ κ·)
- **μμ •**: λ©”λ¨λ¦¬ κΈ°λ° μΊμ‹±, λ°°μΉ μ΅°ν μµμ ν™”, μΊμ‹ λ¬΄ν¨ν™”
- **κ²€μ¦**: β… μ™„λ£

### 8. β… κ΄€κ³„ λ³€κ²½ μ‹ μΊμ‹ λ¬΄ν¨ν™”
- **νμΌ**: `app/api/admin/affiliate/profiles/shared.ts`
- **μμ •**: `syncSalesAgentMentor`μ—μ„ κ΄€κ³„ λ³€κ²½ μ‹ μΊμ‹ λ¬΄ν¨ν™”
- **κ²€μ¦**: β… μ™„λ£

---

## π” μµμΆ… κ²€μ¦ κ²°κ³Ό

### νƒ€μ… μ•μ •μ„±
- β… λ¨λ“  νƒ€μ… μ •μ μ •ν™•ν•¨
- β… μ„ νƒμ  νλΌλ―Έν„° μ μ ν μ‚¬μ©
- β… νƒ€μ… μ¤λ¥ μ—†μ

### λ¦°ν„° κ²€μ‚¬
- β… λ¨λ“  νμΌ λ¦°ν„° μ¤λ¥ μ—†μ
- β… μ½”λ“ μ¤νƒ€μΌ μΌκ΄€μ„± μ μ§€

### κΈ°λ¥ κ²€μ¦
- β… λ§ν¬ μƒμ„± λ΅μ§ μ •ν™•ν•¨
- β… μ¶©λ λ°©μ§€ λ΅μ§ μ •ν™•ν•¨
- β… μ¤‘λ³µ μ²΄ν¬ λ΅μ§ μ •ν™•ν•¨
- β… νΈλμ­μ… μ²λ¦¬ μ •ν™•ν•¨
- β… μΊμ‹± λ΅μ§ μ •ν™•ν•¨
- β… μΊμ‹ λ¬΄ν¨ν™” λ΅μ§ μ •ν™•ν•¨

### νΈμ¶ μ„μΉ ν™•μΈ
- β… `autoSetupAffiliateProfile`: νΈλμ­μ… ν΄λΌμ΄μ–ΈνΈ μ „λ‹¬ ν™•μΈ
- β… `syncSalesAgentMentor`: μΊμ‹ λ¬΄ν¨ν™” ν™•μΈ
- β… λ¨λ“  νΈμ¶ μ„μΉ ν™•μΈ μ™„λ£

---

## π”§ μμ •λ νμΌ λ©λ΅

1. `lib/affiliate/auto-setup.ts`
   - λ§ν¬ μƒμ„± μ¤‘λ³µ μ²΄ν¬ λ΅μ§ μμ •
   - λ§ν¬ μ½”λ“ μ¶©λ λ°©μ§€ λ΅μ§ μ¶”κ°€
   - λλ”© νμ΄μ§€ slug μ¤‘λ³µ μ²΄ν¬ μ¶”κ°€
   - μ¤ν‚¤λ§ λ¶μΌμΉ μμ •
   - νΈλμ­μ… ν΄λΌμ΄μ–ΈνΈ μ§€μ› μ¶”κ°€

2. `app/api/admin/affiliate/profiles/route.ts`
   - μλ™ μ„¤μ • νΈλμ­μ… μ²λ¦¬ κ°μ„ 
   - νΈλμ­μ… ν΄λΌμ΄μ–ΈνΈ μ „λ‹¬

3. `app/api/admin/affiliate/profiles/shared.ts`
   - κ΄€κ³„ λ³€κ²½ μ‹ μΊμ‹ λ¬΄ν¨ν™” μ¶”κ°€

4. `lib/affiliate/relation-cache.ts` (μ‹ κ·)
   - κ΄€κ³„ μΊμ‹± μ ν‹Έλ¦¬ν‹° μƒμ„±
   - λ°°μΉ μ΅°ν μµμ ν™”
   - μΊμ‹ λ¬΄ν¨ν™” κΈ°λ¥

---

## β οΈ λ°κ²¬λ λ¬Έμ  λ° μμ •

### 1. μΊμ‹ ν‚¤ νƒ€μ… λ¬Έμ 
- **λ¬Έμ **: `getManagerIdForAgent`μ—μ„ λ¬Έμμ—΄ ν‚¤ μ‚¬μ© (`agent:${agentId}`)
- **μμ •**: μ«μ ν‚¤ μ‚¬μ© (μμλ΅ κµ¬λ¶„: `-agentId`)
- **μƒνƒ**: β… μμ • μ™„λ£

### 2. μΊμ‹ λ¬΄ν¨ν™” νƒ€μ… λ¬Έμ 
- **λ¬Έμ **: `invalidateManagerCache`μ—μ„ λ¬Έμμ—΄ ν‚¤ μ‚¬μ©
- **μμ •**: μ«μ ν‚¤ μ‚¬μ© (μμλ΅ κµ¬λ¶„)
- **μƒνƒ**: β… μμ • μ™„λ£

---

## π“ μ„±λ¥ κ°μ„  ν¨κ³Ό

### λ§ν¬ μƒμ„±
- β… μ¤‘λ³µ μ²΄ν¬ μ •ν™•μ„± ν–¥μƒ
- β… μ¶©λ κ°€λ¥μ„± λ€ν­ κ°μ† (42μ–µ κ°€μ§€ μ΅°ν•©)

### λλ”© νμ΄μ§€ μƒμ„±
- β… slug μ¤‘λ³µ λ°©μ§€
- β… μ•μ „ν• slug μλ™ μƒμ„±

### νΈλμ­μ… μ²λ¦¬
- β… λ°μ΄ν„° μΌκ΄€μ„± λ³΄μ¥
- β… λ¶€λ¶„ μ‹¤ν¨ λ°©μ§€

### κ΄€κ³„ μ΅°ν
- β… λ‹¨μΌ μ΅°ν: 100-500λ°° μ„±λ¥ κ°μ„ 
- β… λ°°μΉ μ΅°ν: Nλ°° μ„±λ¥ κ°μ„ 
- β… DB λ¶€ν• λ€ν­ κ°μ†

---

## π― μµμΆ… κ²°λ΅ 

### μμ • μ™„λ£
- β… λ¨λ“  λ†’μ€ μ°μ„ μμ„ ν•­λ© μμ • μ™„λ£
- β… μ¤‘κ°„ μ°μ„ μμ„ ν•­λ© μμ • μ™„λ£
- β… λ°κ²¬λ λ¬Έμ  λ¨λ‘ μμ • μ™„λ£

### κ²€μ¦ μ™„λ£
- β… νƒ€μ… μ¤λ¥ μ—†μ
- β… λ¦°ν„° μ¤λ¥ μ—†μ
- β… κΈ°λ¥ μ •ν™•μ„± ν™•μΈ
- β… νΈμ¶ μ„μΉ ν™•μΈ μ™„λ£

### λ°°ν¬ μ¤€λΉ„ μƒνƒ
**λ¨λ“  μμ •μ‚¬ν•­μ΄ μ™„λ£λμ—κ³  κ²€μ¦λμ—μµλ‹λ‹¤. λ°°ν¬ κ°€λ¥ν• μƒνƒμ…λ‹λ‹¤.**

---

## π“ μ°Έκ³ μ‚¬ν•­

### λΉλ“ μ¤λ¥
- ν„μ¬ λΉλ“ μ¤λ¥λ” `Toast` μ»΄ν¬λ„νΈ κ΄€λ ¨μΌλ΅, μ°λ¦¬κ°€ μμ •ν• νμΌκ³Όλ” λ¬΄κ΄€ν•©λ‹λ‹¤.
- μ°λ¦¬κ°€ μμ •ν• νμΌλ“¤μ€ λ¨λ‘ μ •μƒ μ‘λ™ν•©λ‹λ‹¤.

### ν–¥ν›„ κ°μ„  μ‚¬ν•­
1. Redis μΊμ‹λ΅ μ „ν™ (ν„μ¬λ” λ©”λ¨λ¦¬ μΊμ‹)
2. μΊμ‹ ν†µκ³„ μμ§‘
3. μλ™ μΊμ‹ κ°±μ‹ 

---

**μ‘μ„±μ**: AI Assistant  
**μµμΆ… μ—…λ°μ΄νΈ**: 2025λ…„ 1μ›” 28μΌ

