# 🚀 2차 업데이트 작업 계획서

> **작성일**: 2025년 1월 28일  
> **목적**: 배포 전 2차 업데이트 작업 상세 계획  
> **예상 기간**: 약 2-3주 (풀타임 기준)

---

## 📋 작업 목록

### ✅ 1️⃣ AI 기능 강화 (완료됨 - 오류 점검만 필요)

**현재 상태**: AI 기능은 이미 완성되어 있음
- ✅ AI 채팅 스트리밍 응답 완성 (`/api/chat/stream`)
- ✅ RAG 시스템 연동 (`/api/rag/search`, `lib/ai/ragSearch.ts`)
- ✅ AI Tool Calling (코드 확인 필요)

**작업 내용**: 오류 점검만 진행 (예상 시간: 2-3시간)

#### 1-1. AI 기능 오류 점검

**작업 내용**:
1. AI 스트리밍 API 오류 확인
   - `app/api/chat/stream/route.ts` 동작 확인
   - 에러 핸들링 점검
   - 로깅 확인

2. RAG 검색 오류 확인
   - `app/api/rag/search/route.ts` 동작 확인
   - `lib/ai/ragSearch.ts` 확인
   - 검색 결과 정확도 확인

3. Tool Calling 동작 확인
   - Tool Calling 구현 여부 확인
   - "택시비 30달러 썼어" 테스트
   - "체크리스트에 선크림 추가해줘" 테스트

4. 에러 핸들링 점검
   - API 키 누락 시 처리
   - 네트워크 오류 처리
   - 타임아웃 처리

**참고 파일**:
- `app/api/chat/stream/route.ts`
- `app/api/rag/search/route.ts`
- `lib/ai/ragSearch.ts`
- `app/api/chat/route.ts`

**예상 시간**: 2-3시간

---

### 2️⃣ 체크리스트 DB 마이그레이션 (예상 시간: 4-6시간)

**현재 상태**:
- localStorage 사용 중
- 서버 API는 준비됨 (`/api/checklist`)

**작업 내용**:
1. 클라이언트 코드 수정
   - `app/checklist/page.tsx` 수정
   - localStorage 읽기 → API 호출로 변경
   - localStorage 저장 → API POST/PUT으로 변경

2. 초기 로드 시 서버에서 데이터 불러오기
   - 컴포넌트 마운트 시 API 호출
   - 기존 localStorage 데이터 마이그레이션 (선택사항)

3. AI Tool Calling과 연동
   - 체크리스트 API가 완성되면 AI Tool Calling에서 사용 가능

**참고 파일**:
- `app/checklist/page.tsx`
- `app/api/checklist/route.ts` (이미 구현됨)
- `store/checklistStore.ts` (있다면)

**예상 시간**: 4-6시간

---

### 3️⃣ 관리자 UI 개선 (예상 시간: 10-15시간)

#### 3-1. 고객 관리 검색/필터/정렬

**현재 상태**:
- 기본 목록만 표시
- 검색/필터/정렬 기능 없음

**작업 내용**:
1. 검색 기능 추가
   - 이름, 전화번호, 이메일 검색
   - `app/admin/customers/page.tsx` 수정
   - API 수정: `/api/admin/customers`에 검색 파라미터 추가

2. 필터링 기능 추가
   - 상태별 필터링 (활성/휴면/탈퇴)
   - 고객 그룹별 필터링
   - 여행 횟수별 필터링

3. 정렬 기능 추가
   - 가입일순
   - 마지막 접속일순
   - 여행 횟수순

4. 페이지네이션 추가
   - 무한 스크롤 또는 페이지 번호

**참고 파일**:
- `app/admin/customers/page.tsx`
- `app/api/admin/customers/route.ts`

**예상 시간**: 6-8시간

---

#### 3-2. 긴급 공지 발송 UI

**현재 상태**:
- API는 완성됨 (`/api/admin/broadcast`)
- UI 없음 (API 직접 호출 필요)

**작업 내용**:
1. UI 컴포넌트 생성
   - `app/admin/messages/page.tsx` 또는 새 페이지
   - 타겟 그룹 선택 UI
   - 메시지 작성 UI
   - 발송 버튼

2. API 연동
   - `/api/admin/broadcast` 호출
   - 성공/실패 처리

**참고 파일**:
- `app/api/admin/broadcast/route.ts` (이미 구현됨)
- `app/admin/messages/page.tsx`

**예상 시간**: 3-4시간

---

#### 3-3. 마케팅 인사이트 시각화

**현재 상태**:
- 인사이트 생성: ✅
- 데이터 조회: ✅
- 시각화: ❌ 없음

**작업 내용**:
1. 차트 라이브러리 활용
   - Recharts (이미 설치됨)
   - 인사이트 데이터 차트 시각화

2. 인사이트 기반 추천 상품 표시
   - 인사이트 데이터 분석
   - 관련 상품 추천

**참고 파일**:
- `app/admin/data-analysis/page.tsx`
- `app/api/admin/analytics/route.ts`

**예상 시간**: 4-6시간

---

### 4️⃣ 결제 시스템 완성 (예상 시간: 8-12시간)

**현재 상태**:
- 결제 요청 API: ✅ 완성 (`/api/payment/request`)
- 결제 콜백 API: ✅ 완성 (`/api/payment/callback`)
- 웰컴페이먼츠 연동: ❌ 미완성 (TODO 주석)

**작업 내용**:
1. 웰컴페이먼츠 API 연동
   - `app/payment/page.tsx` 92번째 줄 TODO 해결
   - 웰컴페이먼츠 결제 페이지 URL 환경 변수 설정
   - 결제 데이터 전송 로직 구현

2. 환경 변수 설정
   - `NEXT_PUBLIC_WELCOME_PAY_URL` (웰컴페이먼츠 결제 페이지 URL)
   - `PG_MID_AUTH` (웰컴페이먼츠 MID - 인증)
   - `PG_MID_NON_AUTH` (웰컴페이먼츠 MID - 비인증)
   - `PG_MID_PASSWORD` (웰컴페이먼츠 MID 비밀번호)

3. 결제 플로우 테스트
   - 테스트 결제 진행
   - 성공 케이스 확인
   - 실패 케이스 확인

4. 에러 핸들링 강화
   - 결제 실패 시 사용자 안내
   - 재시도 로직
   - 로깅 강화

**참고 파일**:
- `app/payment/page.tsx` (92번째 줄 TODO)
- `app/api/payment/request/route.ts`
- `app/api/payment/callback/route.ts`
- `PAYAPP_SETUP.md` (참고용)

**예상 시간**: 8-12시간

---

### 5️⃣ 번역기 UI 개선 (예상 시간: 4-6시간)

**현재 상태**:
- 기본 기능: ✅ 완성
- 버튼 크기: 기본 크기
- 빠른 문장: 일부만 구현
- 튜토리얼: 기본 튜토리얼 있음

**작업 내용**:
1. 버튼 크기 증가 (50대+ 사용자 고려)
   - 최소 높이 120px
   - 터치 영역 확대
   - `app/translator/page.tsx` 수정

2. 빠른 문장 8개 추가
   - 카테고리별 빠른 문장 8개씩 추가:
     - 식당 주문
     - 쇼핑
     - 교통
     - 응급상황
     - 호텔
     - 관광
     - 의료
     - 일반 대화
   - `app/translator/PHRASE_CATEGORIES_DATA.ts` 수정

3. 튜토리얼 개선
   - 더 친절한 안내
   - 스킵 가능
   - `app/translator/components/TranslatorTutorial.tsx` 수정

**참고 파일**:
- `app/translator/page.tsx`
- `app/translator/PHRASE_CATEGORIES_DATA.ts`
- `app/translator/components/TranslatorTutorial.tsx`

**예상 시간**: 4-6시간

---

## 📊 작업 일정

| 작업 | 예상 시간 | 우선순위 | 시작일 | 완료일 |
|------|----------|---------|--------|--------|
| AI 기능 오류 점검 | 2-3시간 | 🟢 낮음 | - | - |
| 체크리스트 DB 마이그레이션 | 4-6시간 | 🟡 중간 | - | - |
| 관리자 UI 개선 | 10-15시간 | 🟡 중간 | - | - |
| 결제 시스템 완성 | 8-12시간 | 🔴 높음 | - | - |
| 번역기 UI 개선 | 4-6시간 | 🟡 중간 | - | - |
| **총 예상 시간** | **28-42시간** | - | - | - |

**예상 작업 기간**: 약 1-2주 (풀타임 기준)

---

## ✅ 작업 완료 체크리스트

### AI 기능 오류 점검
- [ ] AI 스트리밍 API 오류 확인
- [ ] RAG 검색 오류 확인
- [ ] Tool Calling 동작 확인
- [ ] 에러 핸들링 점검

### 체크리스트 DB 마이그레이션
- [ ] localStorage → 서버 DB 연동
- [ ] 초기 로드 시 서버에서 데이터 불러오기
- [ ] AI Tool Calling과 연동

### 관리자 UI 개선
- [ ] 고객 관리 검색/필터/정렬
- [ ] 긴급 공지 발송 UI
- [ ] 마케팅 인사이트 시각화

### 결제 시스템 완성
- [ ] 웰컴페이먼츠 API 연동
- [ ] 환경 변수 설정
- [ ] 결제 플로우 테스트
- [ ] 에러 핸들링 강화

### 번역기 UI 개선
- [ ] 버튼 크기 증가
- [ ] 빠른 문장 8개 추가
- [ ] 튜토리얼 개선

---

## 🎯 배포 전 최종 체크리스트

- [ ] 모든 2차 업데이트 작업 완료
- [ ] 디버그 로그 정리 (프로덕션 환경)
- [ ] 환경 변수 설정 확인
- [ ] 데이터베이스 마이그레이션 확인
- [ ] HTTPS 설정 확인
- [ ] 전체 기능 테스트
- [ ] 결제 플로우 테스트
- [ ] AI 기능 테스트

---

**작성일**: 2025년 1월 28일  
**목표 배포 시기**: 2차 업데이트 작업 완료 후 (약 1-2주 후)  
**참고**: AI 기능 강화는 이미 완료되어 오류 점검만 진행

